<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://gilgamel.github.io</id>
    <title>Gilgamel&apos;s Notepad</title>
    <updated>2021-04-06T05:05:24.558Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://gilgamel.github.io"/>
    <link rel="self" href="https://gilgamel.github.io/atom.xml"/>
    <logo>https://gilgamel.github.io/images/avatar.png</logo>
    <icon>https://gilgamel.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Gilgamel&apos;s Notepad</rights>
    <entry>
        <title type="html"><![CDATA[通过 Query、Importrange、Select、Where 将多张 Google Sheets 合并到一起]]></title>
        <id>https://gilgamel.github.io/post/google_sheets_merge_multiple_sheets/</id>
        <link href="https://gilgamel.github.io/post/google_sheets_merge_multiple_sheets/">
        </link>
        <updated>2021-04-02T08:20:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="背景">背景</h2>
<p>公司每个学期所做的 Budget 都放在 Google Sheet，大概每2-4周会出现频繁修改的情况，因此需要实时保持更新并连接到 PBI。</p>
<p>在之前曾经试过 Custom Goolge Sheet Connector，但由于 Connector 只能在 Desktop 使用，会影响将报表 push 到 PBI Service 后的刷新；也曾经试过将 Power Query 写到 PBI Service 上，但由于 credential 问题，会导致后续无法刷新。</p>
<p>由于每个分公司的 Budget 都会在一张 spreadsheet 上，基于保密因此需要先将分公司的 Budget 有选择性地抓到同一张表上，再连接到 PBI Service 上。</p>
</br>
<h2 id="总结">总结</h2>
<p>基于以上背景，可简单总结为以下两个目的：</p>
<ol>
<li>Merge Multiple Sheets into One Sheet</li>
<li>Connect Goolge Sheet to PBI Service and Schedule Refresh</li>
</ol>
</br>
<h2 id="step-1-merge-multiple-sheets">STEP 1. Merge Multiple Sheets</h2>
<h3 id="step-11-filter-importrange失败的尝试">STEP 1.1 Filter + Importrange，失败的尝试</h3>
</br>
<pre><code>= {
    FILTER(IMPORTRANGE(&quot;{Spreadsheet_link1}&quot;,&quot;Sheet_name!A2:A&quot;),
    LEN(IMPORTRANGE(&quot;{Spreadsheet_link},&quot;Sheet_name!H2:H))&gt;0;
    FILTER(IMPORTRANGE(&quot;{Spreadsheet_link2}&quot;,&quot;Sheet_name!A3:A&quot;),
    LEN(IMPORTRANGE(&quot;{Spreadsheet_link2}&quot;,&quot;Sheet_name!H3:H&quot;))&gt;0)
}
</code></pre>
<ul>
<li><strong>{Spreadsheet_link1}</strong> 分公司A的 Google Sheet Link</li>
<li><strong>{Spreadsheet_link2}</strong> 分公司B的 Google Sheet Link</li>
<li><strong>Sheet_name1!A2:A</strong>由于是第一次抓表，因此需要将标题也一同抓取。在这次的 Budget 表里第二行为标题，因此公司A的表格从A2开始抓起</li>
<li><strong>Sheet_name2!A3:A</strong>接着是 merge 公司B的表格，由于此时已不需要标题了，因此可以由 A3 开始抓起</li>
<li>通过 FILTER以及LEN 将已经没有填写完成的内容暂时放弃抓取，LEN里的 <strong>filter</strong> 判定行数需要跟 <strong>importrange</strong> 保持一致<br>
</br><br>
到此为止，其实已经可以成功将各分公司的表格合并到一起。但出于信息安全保密问题，因此需要跳列只抓取最为重要的几列，以确保及时资料外泄对方也不知道具体产品的对应 Budget 是多少。</li>
</ul>
<p>由于 filter 跟 importrange 均无法跳列，因此开始尝试使用 query + select + where + importrange 的组合进行数据抓取。<br>
</br></p>
<h3 id="step-12-query-importrange-select-where">STEP 1.2 Query + Importrange + Select + Where</h3>
</br>
<h2 id="ref">Ref</h2>
<blockquote>
<p>https://stackoverflow.com/questions/45945815/how-to-connect-google-sheet-with-power-bi</p>
<p>https://webapps.stackexchange.com/questions/85101/queryimportrange-function-to-skip-columns</p>
<p>https://webapps.stackexchange.com/questions/93002/unable-to-parse-query-string-for-function-query-when-using-importrange</p>
<p>https://blog.coupler.io/combine-sheets-into-one/</p>
<p>https://blog.coupler.io/query-importrange/#What_you_can_do_with_IMPORTRANGEQUERY_functions_real-life_formula_examples</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[202103]]></title>
        <id>https://gilgamel.github.io/post/202103_daily/</id>
        <link href="https://gilgamel.github.io/post/202103_daily/">
        </link>
        <updated>2021-02-26T03:23:17.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>2021/3/1：3月的第一天养成好习惯，每天给自己记录一句话吧</li>
<li>2021/3/2：微信给我姐发了句“生日快乐”，除此以外好像也没什么好说的。</li>
<li>2021/3/3：跟我妈说起准备辞职的事情，十分有啃老意识的想要她帮忙找个后门。怎么说呢，自己也很清楚明白找后门这东西不是义务必须，可就会忍不住在想为什么当年能够帮我姐铺路，而我什么都没有呢。</li>
<li>2021/3/4：发现信用卡在不知情的情况下被刷了，瞬间心态爆炸。在推上看到关于发定时自杀WB的tweet时瞬间感觉到共鸣，真的好累。躲被窝里自闭一会继续看书。</li>
<li>2021/3/5：PMBOK 真的很绕，不过是一个好的开始</li>
<li>2021/3/6：好耶！终于见到糊糊了！糊糊真是只甜美的小猫咪！</li>
<li>2021/3/7：好久没试过跟人睡在一张床上了，心情有点微妙</li>
<li>2021/3/8：天葬真是一项既有意义、又有味道的宗教性活动</li>
<li>2021/3/9：成年人需要克制，不可以将白纸诱惑性染黑。啊，打脸了，染黑了。</li>
<li>2021/3/10：荷尔蒙上头</li>
<li>2021/3/11：荷尔蒙上头中带着一点愧疚</li>
<li>2021/3/12：今天听了少楠关于产品沉思录的 podcast 觉得挺有意思，利用项目管理去分解恐惧；将焦虑转化为恐惧。</li>
<li>2021/3/17：时间像是被吞掉，中间的时间不知道哪儿去了。今天放弃了QNAP的ARIA，安装了TRANSMISSION，从此我也能用NAS做下载鸡了。好耶</li>
<li>2021/3/24：像我这么枯燥的人坚持每天记录真的好难。今天开始尝试写公司的业务分析，business model canvas 看着简单，真正写的时候的确需要思考</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Nespresso Vertuo Coffee Capsules 口味记录]]></title>
        <id>https://gilgamel.github.io/post/nespresso-vertuo-coffee-capsules-kou-wei-ji-lu/</id>
        <link href="https://gilgamel.github.io/post/nespresso-vertuo-coffee-capsules-kou-wei-ji-lu/">
        </link>
        <updated>2021-02-25T04:41:28.000Z</updated>
        <content type="html"><![CDATA[<h2 id="solelio">Solelio</h2>
<ul>
<li>Intensity: 2/10</li>
<li>Cup Size: 230ml</li>
<li>Aromatic Profile: Fruity and Light-Bodied</li>
<li>Aromatic Notes: Citric, Cereal</li>
</ul>
<p>整体口感温和，烘培感跟果味的平衡恰到好处，但在冷却后酸度会大为提升。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[为 Gridea Github Page 自定义域名并开启 https]]></title>
        <id>https://gilgamel.github.io/post/github_page_ssl/</id>
        <link href="https://gilgamel.github.io/post/github_page_ssl/">
        </link>
        <updated>2021-02-21T20:25:53.000Z</updated>
        <content type="html"><![CDATA[<p>最近发现了 Gridea 这个静态博客，感觉十分方便，重新将持续性写 blog 提上日程</p>
<p>就算是2021年立一个 flag 吧。</p>
<p>Gridea 真的是一个非常方便的静态博客，连自定义域名的方式都非常的傻瓜。</p>
<h2 id="具体操作">具体操作</h2>
<p>在 Gridea 左侧选择<strong>远程</strong>，然后直接在** CNAME** 输入自己的域名，点击保存同步即可。</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2021/02/26/q2FPwmiz7ajsS3O.png" alt="gridea_setting.png" loading="lazy"></figure>
<p>登陆 GITHUB，看到多了一个 CNAME 文件即代表同步成功。</p>
<p>点击 <strong>Setting</strong> 拖到下方，确认域名已经被填写进去，并且 **ENFORCE HTTPS **已被勾选成功。</p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2021/02/26/zyaxo9NQlfJVB7L.png" alt="GITHUB_PAGE_SETTING.png" loading="lazy"></figure>
<h2 id="其他">其他</h2>
<p>其实一开始有在搜了很多教程，包括在 github page 直接 create new file CNAME， 然后输入域名。</p>
<p>后来发现这个操作在 Gridea 更新同步后，CNAME file 会被删除，因此作罢。</p>
<p>其后试过直接在 Gridea 源目录下新建 CNAME file，但发现同步不成功。</p>
<p>最后发现 Gridea 十分贴心的在客户端已经自带了设置。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[银河后期]]></title>
        <id>https://gilgamel.github.io/post/milky-way-editing/</id>
        <link href="https://gilgamel.github.io/post/milky-way-editing/">
        </link>
        <updated>2019-08-25T14:00:40.000Z</updated>
        <content type="html"><![CDATA[<p>抓住19年拍银河的小尾巴，跟特特还有海王去了 Toronto Barren 拍银河。</p>
<p>俗话说得好：拍摄一时爽，后期火葬场。</p>
<p>用来拍摄的单反是 long time ago 的60D，由于是APS-C画幅，所以拍摄时的思路是用 <strong>高感 + 大光圈 + 慢快门</strong> 尽可能将更多的星星拍摄进去。然而忽略了机子的问题，等看到RAW的时候发现噪点十分多，修起来真的是太难了。在找了好多个preset以后发现颜色出来都不大自然（至少比我目前修出来的还不自然），所以无法偷懒的自己开始不断 google 着。</p>
<p>用的参数是 3200 ISO + f2.8 + 30s，拍摄6张以后拼接在一起。原图大概是这个亚子的：</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/08/27/NRu19LOZD7KmnAt.jpg" alt="BIBBB-2.jpg" loading="lazy"></figure>
<h2 id="camera-raw-基修">Camera RAW 基修</h2>
<p>在LR里将6张图拼接导出以后，用 Camera RAW 打开了图片。由于在LR里已经预先将图片都进行了镜头校对，所以在 Camera RAW 里就省去这一步了。</p>
<p>直接对对比度、高光、阴影、白色、黑色进行修改，重点是将图片调灰</p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/08/27/g6XyOVDNb5RolhL.png" alt="image.png" loading="lazy"></figure>
<p><strong>高光</strong></p>
<p>提高高光可以使银心更加明亮，</p>
<p><strong>阴影</strong></p>
<p>提高阴影可以使暗部提高一些，显示出细节</p>
<p><strong>黑色</strong></p>
<p>提高黑色一样可以显示出细节</p>
<p><strong>白色</strong></p>
<p>降低白色可以让图片整体亮度稍微压低一点</p>
<p><strong>对比度</strong></p>
<p>适当调低可以方便PS后期修整</p>
<p>除此以外，还需要适当增加清晰度以及自然饱和度，曝光度根据图片情况选择性加/不加。</p>
<h3 id="降噪">降噪</h3>
<p>将 Camera RAW 调到细节，然后开始降噪</p>
<p>注意蒙版需要稍微调大一点，颜色也需要降噪，否则会出现噪点过多的问题</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/08/27/wa1cR4VgHOfMbtz.png" alt="image.png" loading="lazy"></figure>
<h2 id="photoshop-修饰">Photoshop 修饰</h2>
<h3 id="明暗修饰">明暗修饰</h3>
<h4 id="亮部修饰">亮部修饰</h4>
<p>利用快捷键 <strong>CTRL + ALT + 2</strong> 选取高光部位。</p>
<p>这时画面上会出现闪闪发亮的就是高光部位，然后用调整层工具 <strong>曲线</strong> 进行修饰</p>
<p>由于我们现在选取了高光部位，所以操作仅仅会针对亮的部分进行。</p>
<p>通过拖动曲线，让亮的地方更亮，把比较灰的地方拉下来。</p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/08/27/2SFZaTUIGe7vuOq.png" alt="image.png" loading="lazy"></figure>
<h4 id="暗部修饰">暗部修饰</h4>
<p>按着曲线部分的蒙版（曲线）选区，CTRL + ALT +2 选择高光部位后，然后在菜单栏选择 <strong>反选</strong>，接着再加曲线。</p>
<p>这时需要将暗部提亮，但是比较暗的地方需要继续压下去</p>
<figure data-type="image" tabindex="5"><img src="https://i.loli.net/2019/08/27/lypVeYR97vSEUhA.png" alt="image.png" loading="lazy"></figure>
<h4 id="整体层次修整">整体层次修整</h4>
<p>在不选择高光部位的情况下，添加曲线，对整体明暗进行修饰</p>
<figure data-type="image" tabindex="6"><img src="https://i.loli.net/2019/08/27/jArR4msZYCFIoEi.png" alt="image.png" loading="lazy"></figure>
<p>Ref：</p>
<blockquote>
<p>https://www.xinpianchang.com/a71314?from=ArticleList</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Excel Remove Duplicate]]></title>
        <id>https://gilgamel.github.io/post/Removeduplicate/</id>
        <link href="https://gilgamel.github.io/post/Removeduplicate/">
        </link>
        <updated>2019-08-20T03:25:00.000Z</updated>
        <summary type="html"><![CDATA[<p>最近一直在做活动，报名方式为麦客单表，但由于经常性会出现重复性报名情况，所以需要在统计之前对数据进行清洗。</p>
<p>出现重复报名的情况一般如下：</p>
<ol>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>B活动&amp;A活动</strong></li>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>C活动</strong></li>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>A活动&amp;B活动&amp;C活动</strong></li>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>A活动&amp;C活动&amp;D活动</strong></li>
</ol>
]]></summary>
        <content type="html"><![CDATA[<p>最近一直在做活动，报名方式为麦客单表，但由于经常性会出现重复性报名情况，所以需要在统计之前对数据进行清洗。</p>
<p>出现重复报名的情况一般如下：</p>
<ol>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>B活动&amp;A活动</strong></li>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>C活动</strong></li>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>A活动&amp;B活动&amp;C活动</strong></li>
<li>报名了 <strong>A活动&amp;B活动</strong>后，又再报名了 <strong>A活动&amp;C活动&amp;D活动</strong></li>
</ol>
<!-- more -->
<h2 id="思路">思路</h2>
<h3 id="合并去掉重复行">合并/去掉重复行</h3>
<p>根据报名表的设置，一般都会有 <strong>姓名、手机、微信、邮箱、参与活动</strong> 这几项，而其中姓名跟手机是大概率是唯一，which means不会重复的，所以将使用姓名/手机作为检测项</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/08/22/vNIyXZYmdtxBoWS.png" alt="Snipaste_2019-08-21_23-54-49.png" loading="lazy"></figure>
<p>在以姓名作为检测项对齐进行排列后，可以看出这个叫 Ada 的少年一口气重复报名了三次，并且第二、三次报得是完全一样的，现在要做的就是 <strong>将同一个姓名的人选择参加的活动全部合并在一起</strong></p>
<p>在活动后面一列起个小标题 <strong>1</strong> 写上以下code：</p>
<pre><code class="language-Excel">=if(A2=A1, F1&amp;&quot;;&quot;&amp;E2, E2)

# 如果 A2=A1，就将F1跟E2内容合并到一块，中间用；来表示，否则就显示E2
</code></pre>
<p>完事儿将公式拉完这一列。 在 <strong>列1</strong> 后面再弄一个 <strong>列2</strong>，写上以下code：</p>
<pre><code class="language-Excel">=if(A2&lt;&gt;A3, &quot;Merged Value&quot;, &quot; &quot;)

# 如果 A2 不等于 A3，那么就显示为 Merged Value，否则显示空白
</code></pre>
<p>同理，将公式拉满 <strong>列2</strong>；接着将 <strong>列1&amp;列2</strong> 都选上，然后 <strong>copy &amp; paste value only</strong>，将这两列的数值都变为plain text</p>
<p>接下来将 <strong>列2</strong> 选中，并且进行 <strong>自定义排序</strong></p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/08/22/rQgEpokvaZxhbYt.png" alt="image.png" loading="lazy"></figure>
<p>选择 <strong>扩展选定区域</strong>，然后将主要关键字选为 <strong>2</strong>，次序为 <strong>降序</strong></p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/08/22/NkeDbcPUOSME1xY.png" alt="image.png" loading="lazy"></figure>
<p>最后将 <strong>列2</strong> 最下方显示为 <strong>空白</strong>的几行删掉即可。</p>
<h3 id="去掉重复活动remove-duplicate">去掉重复活动（Remove Duplicate）</h3>
<p>在VBA上新建Module，输入以下code：</p>
<pre><code class="language-Excel">Function RemoveDupes2(txt As String, Optional delim As String = &quot; &quot;) As String
    Dim x
    'Updateby20140924
    With CreateObject(&quot;Scripting.Dictionary&quot;)
        .CompareMode = vbTextCompare
        For Each x In Split(txt, delim)
            If Trim(x) &lt;&gt; &quot;&quot; And Not .exists(Trim(x)) Then .Add Trim(x), Nothing
        Next
        If .Count &gt; 0 Then RemoveDupes2 = Join(.keys, delim)
    End With
End Function
</code></pre>
<p>Module创建完毕后，在新的空白列上输入以下code：</p>
<pre><code class="language-Excel">=removedupes2(E2,&quot;;&quot;)

# remove deplicate from E2, ; is seperator
</code></pre>
<p>最后将新列上的数据 <em><em>copy &amp;</em> paste value only</em>*以后，即可删掉之前合并的重复活动列。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[在Google Sheet上使用query、if、isna将符合条件的分表数据汇总到总表]]></title>
        <id>https://gilgamel.github.io/post/google-sheet-query/</id>
        <link href="https://gilgamel.github.io/post/google-sheet-query/">
        </link>
        <updated>2019-08-19T04:35:27.000Z</updated>
        <summary type="html"><![CDATA[<p>因为工作的缘故，需要将各个平台的宣传日期都放在一张google sheet上，然后 <strong>通过检测关键词，将关键的event自动pop up到总表上</strong>。得到这个需求的时候，脑海里立刻想到的是VBA，然而google sheet上压根没VBA啊！<br>
</br><br>
于是想着是否能用 vlookup/hlookup/index &amp; match解决问题，最后发现果然还是解决不了：）最后在朋友的提醒下，开始摸索着使用 <strong>query</strong>。</p>
<h2 id="query">Query</h2>
<p>根据 Google 简陋的说明，query 是对数据运行一项采用 Google Visualization API 查询语言的查询。</p>
]]></summary>
        <content type="html"><![CDATA[<p>因为工作的缘故，需要将各个平台的宣传日期都放在一张google sheet上，然后 <strong>通过检测关键词，将关键的event自动pop up到总表上</strong>。得到这个需求的时候，脑海里立刻想到的是VBA，然而google sheet上压根没VBA啊！<br>
</br><br>
于是想着是否能用 vlookup/hlookup/index &amp; match解决问题，最后发现果然还是解决不了：）最后在朋友的提醒下，开始摸索着使用 <strong>query</strong>。</p>
<h2 id="query">Query</h2>
<p>根据 Google 简陋的说明，query 是对数据运行一项采用 Google Visualization API 查询语言的查询。</p>
<!-- more -->
<h3 id="用法示例">用法示例</h3>
<pre><code class="language-Excel">QUERY(A2:E6,&quot;select avg(A) pivot B&quot;)

QUERY(A2:E6,F2,FALSE)
</code></pre>
<h3 id="语法">语法</h3>
<p><strong>Query（数据，查询，[标题数]）</strong></p>
<ul>
<li><strong>数据</strong> - 要执行查询的单元格范围。
<ul>
<li>每列<strong>数据</strong>中的数值类型只能是布尔值、数字（包括日期/时间类型）或字符串。</li>
<li>如果有多种数据类型掺杂在单个列中，为便于查询，该列的数据类型由其中大多数数据的类型决定。其他少数数据的类型则被视为空值。</li>
</ul>
</li>
<li><strong>查询</strong> - 要执行的查询操作，以 <strong>Google Visualization API查询语言</strong>编写。
<ul>
<li><strong>查询</strong>的值必须括在<strong>引号</strong>中，否则该值必须是指向包含相关文本的单元格的引用。</li>
</ul>
</li>
<li><strong>标题数</strong> - [可选]- <code>数据</code>上方的标题行的数目。如果省略或设置为<code>-1</code>，将根据<strong>数据</strong>的内容估算该值。</li>
</ul>
<h3 id="可以怎么用">可以怎么用？</h3>
<table>
<thead>
<tr>
<th>name</th>
<th>dept</th>
<th>lunchTime</th>
<th>salary</th>
<th>hireDate</th>
<th>age</th>
<th>isSenior</th>
<th>seniorityStartTime</th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Eng</td>
<td>12:00:00</td>
<td>1000</td>
<td>3/19/2005</td>
<td>35</td>
<td>TRUE</td>
<td>12/2/2007 15:56:00</td>
</tr>
<tr>
<td>Dave</td>
<td>Eng</td>
<td>12:00:00</td>
<td>500</td>
<td>4/19/2006</td>
<td>27</td>
<td>FALSE</td>
<td>null</td>
</tr>
<tr>
<td>Sally</td>
<td>Eng</td>
<td>13:00:00</td>
<td>600</td>
<td>10/10/2005</td>
<td>30</td>
<td>FALSE</td>
<td>null</td>
</tr>
<tr>
<td>Ben</td>
<td>Sales</td>
<td>12:00:00</td>
<td>400</td>
<td>10/10/2002</td>
<td>32</td>
<td>TRUE</td>
<td>3/9/2005 12:30:00</td>
</tr>
<tr>
<td>Dana</td>
<td>Sales</td>
<td>12:00:00</td>
<td>350</td>
<td>9/8/2004</td>
<td>25</td>
<td>FALSE</td>
<td>null</td>
</tr>
<tr>
<td>Mike</td>
<td>Marketing</td>
<td>13:00:00</td>
<td>800</td>
<td>1/10/2005</td>
<td>24</td>
<td>TRUE</td>
<td>12/30/2007 14:40:00</td>
</tr>
</tbody>
</table>
<ol>
<li>使用<strong>Select</strong>和<strong>Where</strong>橘子返回满足指定条件的行。</li>
</ol>
<pre><code class="language-Excel">QUERY('Example Data'!$A$2:$H$7, &quot;select A where (B&lt;&gt;'Eng' and G=true) or (D &gt; &quot;&amp;A2&amp;&quot;)&quot;)
</code></pre>
<ol start="2">
<li>使用<strong>Select</strong>和<strong>Group by</strong>子句统计所有行的<strong>工资</strong>数据</li>
</ol>
<pre><code class="language-Excel">QUERY('Example Data'!$A$2:$H$7, &quot;select B, MAX(D) group by B&quot;)
</code></pre>
<ol start="3">
<li>将各列不重复的值转换到新列中。</li>
</ol>
<pre><code class="language-Excel">QUERY('Example Data'!$A$2:$H$7, &quot;select avg(D) pivot B&quot;)
</code></pre>
<ol start="4">
<li>统计各行的<strong>部门</strong>值，并按<strong>工资</strong>的最大值进行排序。</li>
</ol>
<pre><code class="language-Excel">QUERY('Example Data'!$A$2:$H$7, &quot;select B, MAX(D) group by B order by MAX(D)&quot;)
</code></pre>
<ol start="5">
<li>指定输入范围中的标题行数目，这让函数能够将带多个标题行的输入转换为单个标题行的输入。</li>
</ol>
<pre><code class="language-Excel"># Male
QUERY(A1:E4, &quot;select B where (D&gt;175 and E&gt;53)&quot;, 1)

# Male height
QUERY(A1:E4, &quot;select B where (D&gt;175 and E&gt;53)&quot;, 2)
</code></pre>
<p>其实以上都不是重点，只是我想Mark一下而已。</p>
<h2 id="利用-query-where-contains-自从筛选出符合条件的-event">利用 Query 、Where、Contains 自从筛选出符合条件的 Event</h2>
<p>由于当时设计timeline只考虑到好看（easy to read）的问题，所以基本上将 Google Sheet 当成了画板使用，这也导致了 timeline 的设计从数据分析的逻辑上来看是十分辣鸡的；但木得办法，老板要“好看”，所以只能基于原有timeline的基础上去做到老板想要的需求。</p>
<p>以下为“好看”（easy to read) 的timeline示例：</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/08/23/OvHFniK8xLrat4f.png" alt="image.png" loading="lazy"></figure>
<p>考虑到 Google Sheet 只能默认某一列的日期是一致的，所以没办法一口气将所有区域选上并且进行筛选，所以只能用一个笨方法：将range设置为一周。</p>
<p>举个例子：假设12月23日 - 12月29日的 range 为 C174:I180，Monday 代表C列，我需要在总表上代表12月23日的一格输入以下代码：</p>
<pre><code class="language-Excel">query(xxxx!$C$174:$I$180,&quot;select C where C contains '线下'&quot;)

# 在$C$174:$I$180的范围内，自从标记出在C列里包含着线下这两个关键字的内容
# 同理线下可以切换为线上或执行
</code></pre>
<p>到了这一步，问题得到了解决。</p>
<p>但新的问题又出现了</p>
<h3 id="用-isna-if-function-将在没有关键性-event-的格子里会出现-na-提示去掉">用 isna 、if function 将在没有关键性 Event 的格子里会出现 #N/A 提示去掉</h3>
<p>这个提示是由 query function 直接产生的，所以无法使用 conditional format 进行标白处理，因此在朋友的提示下，我选择使用 <strong>isna</strong> function.</p>
<p><strong>isna</strong> function 是用来检查某个值是否为错误值 #N/A 的。</p>
<ul>
<li><strong>ISNA（值）</strong>
<ul>
<li><strong>值</strong> - 要与错误值 #N/A 进行比较的值</li>
<li>如果<strong>值</strong>为**#N/A<strong>或指向包含</strong>#N/A<strong>的单元格的引用，则</strong>ISNA**将返回TRUE，否则返回FALSE</li>
</ul>
</li>
</ul>
<pre><code class="language-Excel">isna(query(UTSG!$M$4:$S$10,&quot;select O where O contains '线下'&quot;))

# 检测 query(UTSG!$M$4:$S$10,&quot;select O where O contains '线下'&quot;) 的返回值是否为 #N/A， 如果是返回TRUE， 否则返回 FALSE
</code></pre>
<p>当 query function 指向 #N/A 时，会自动返回 TRUE， 此时已达到将 #N/A 去掉的目的。之后可配合 <strong>if function</strong> 将TURE值转换为空格。</p>
<pre><code class="language-Excel">if(isna(query(UTSG!$M$4:$S$10,&quot;select O where O contains '线下'&quot;)),&quot; &quot;, query(UTSG!$M$4:$S$10,&quot;select O where O contains '线下'&quot;))

# 如果 ISNA 返回的值为TURE，则将TRUE 变为空格，否则显示qury function 返回值。
</code></pre>
<p>至此，老板的需求已经完成。让我大吼一句 Google Sheet 真好玩。</p>
<h3 id="其他">其他</h3>
<p>在Google Sheet 上可使用 CTRL + ` 来显示出 formula，然后使用 formula replace 一键替换公式里的关键词。</p>
<p>Ref:</p>
<blockquote>
<p>https://support.google.com/docs/answer/3093343?hl=zh-Hans</p>
<p>https://support.google.com/docs/answer/3093293?hl=zh-Hans</p>
<p>https://infoinspired.com/google-docs/spreadsheet/contains-substring-match-in-google-sheets-query-for-partial-match/</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[悬空寺：危楼高百尺]]></title>
        <id>https://gilgamel.github.io/post/Shanxi-day2/</id>
        <link href="https://gilgamel.github.io/post/Shanxi-day2/">
        </link>
        <updated>2019-05-06T05:56:37.000Z</updated>
        <content type="html"><![CDATA[<p>早上6点30左右在华林新天地靠城墙上车，对比起飞猪上的图案，马蜂窝这个团的车子显得有点一言难尽……例如还有座位是坏了的……</p>
<p>路上是一路睡过去的，就不多说了。</p>
<h2 id="悬空寺">悬空寺</h2>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/06/25/5d1197101a3ef91480.jpg" alt="标准游客照" loading="lazy"></figure>
<blockquote>
<p>一直以来关于悬空寺都流传着这样的俚语：<strong>悬空寺，半天高，三根马尾空中吊。</strong></p>
<p>悬空寺建于公元419年（北魏），是佛、道、儒三教合一的独特寺庙。悬空寺原本叫玄空阁，玄取自于中国传统宗教道教教理，空则来源于佛教的教理。</p>
<p>在唐开元23年（公元735年），李白留下壮观二字，现存建筑是明清两代时修缮的遗物。悬空寺乃一院两楼布局，楼阁殿宇40间，总长约32米。总体布局有寺院、禅房、佛堂、三佛殿、太乙殿、关帝庙、鼓楼、钟楼、珈蓝殿、送子观音殿、释迦殿、雷音殿、三宫殿、纯阳宫、栈道、三教殿、五佛殿等……</p>
</blockquote>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/06/25/5d119aa071fef96033.jpg" alt="皮皮瘦游客照" loading="lazy"></figure>
<p>给皮皮瘦来一张游客照，感觉自从有了皮皮瘦，我对于用嘴唇去对焦这事情已经越发娴熟了……</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/06/25/5d119bc358f8576220.jpg" alt="悬空寺侧面" loading="lazy"></figure>
<p>去悬空寺的时候由于错开了五一高峰，基本不需要排队。然而真正站在上面时腿都在抖。因为真的很！晃！！！啊！！</p>
<blockquote>
<p>悬空寺全死初看上去只有几十根大约碗口粗的木柱支撑，最高处距离地面50来米；以半插横梁为基础，借助岩石的托付，回廊栏杆上下梁柱左右紧密相连成一整个木质框架式结构。</p>
</blockquote>
<p>一样是跟了一个不大靠谱的导游，一路上半知半解。回来照旧 google 一下你就知道，于是找到了以上解析，而且还来自于导游词稿；互联网万岁。</p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/06/25/5d119daf9050714377.jpg" alt="楼梯" loading="lazy"></figure>
<p>楼梯还超级陡的，几乎成90度的楼梯需要手脚并用才得去，上得时候因为背着书包，还差点一个不小心就卡在楼梯口。</p>
<figure data-type="image" tabindex="5"><img src="https://i.loli.net/2019/06/25/5d119effd1bf940652.jpg" alt="萌萌哒佛像" loading="lazy"></figure>
<p>这个也不知道是什么佛像，但是眼睛位置特别明亮，应该是用了琉璃之类的镶嵌上去的。</p>
<figure data-type="image" tabindex="6"><img src="https://i.loli.net/2019/06/25/5d119f028a3c721921.jpg" alt="不知名佛庙" loading="lazy"></figure>
<figure data-type="image" tabindex="7"><img src="https://i.loli.net/2019/06/25/5d119f0387bbf41990.jpg" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="8"><img src="https://i.loli.net/2019/06/25/5d119f0548f3574439.jpg" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="9"><img src="https://i.loli.net/2019/06/25/5d119f0483bc793944.jpg" alt="纯阳宫" loading="lazy"></figure>
<p>这座纯阳宫是去了山西以后第一次看到，当时十分兴奋拍了下来准备发给岚狗看的，到了后来越发审美疲劳。</p>
<p>对了，悬空寺山下，不对应该是恒山山脚下还有一座小悬空寺，但目前由于路况问题已经暂时关闭了。一路走着的时候宗让我想起某不知名小说就是关于大小悬空寺的。</p>
<h2 id="恒山">恒山</h2>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[崇善寺：佛香青烟袅袅]]></title>
        <id>https://gilgamel.github.io/post/Shanxi-day1/</id>
        <link href="https://gilgamel.github.io/post/Shanxi-day1/">
        </link>
        <updated>2019-05-04T05:41:06.000Z</updated>
        <content type="html"><![CDATA[<!-- more -->
<p><strong>行程安排：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">日期</th>
<th>行程</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">5.6</td>
<td>广州 - 太原 （崇善寺） - 大同</td>
</tr>
<tr>
<td style="text-align:center">5.7</td>
<td>悬空寺 - 恒山 - 云冈石窟 - 大同古城墙</td>
</tr>
<tr>
<td style="text-align:center">5.8</td>
<td>纯阳宫 - 关帝庙 - 九龙壁 - 四牌楼 - 清真大寺 - 华严寺 - 平遥（火车）</td>
</tr>
<tr>
<td style="text-align:center">5.9</td>
<td>日昇昌&amp;蔚泰厚 - 武林汇 - 古县衙 - 珍奇报纸陈列馆 - 城隍庙</td>
</tr>
<tr>
<td style="text-align:center">5.10</td>
<td>王家大院 - 平遥古城墙 - 二郎庙 - 庆同协 - 同兴公镖局 - 文庙 - 华北镖局 - 太原</td>
</tr>
<tr>
<td style="text-align:center">5.11</td>
<td>中国煤炭博物馆 - 山西博物院 - 食品街</td>
</tr>
<tr>
<td style="text-align:center">5.12</td>
<td>太原工人文化宫 - 广州</td>
</tr>
</tbody>
</table>
<h2 id="太原机场">太原机场</h2>
<p>由于这次机票时间订得不上不下的，于是下了飞机以后上了机场大巴直奔火车站。在这里想吐槽一下机场大巴，终点站叫火车站，但下了车以后还需要坐一站公交车 -_-|||</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/06/22/5d0dbb584682f42830.jpg" alt="2019-05-06 太原火车站" loading="lazy"></figure>
<p>到了火车站以后将自己20寸的小箱子寄存，不晓得这么小的箱子怎么就成了寄存的 highest price rank， 收了15块而且还只能给现金！好不容易寄存了行李，傻乎乎的排队买了去大同的火车票，就顺着指示牌下了楼梯打的去<strong>崇善寺</strong>了。结果司机听到我说去崇善寺，整个脸都黑了，说我这是坑人。原来负一层的打的站台起码得等30分钟……emmmm 虽然有点不大好意思，可是……都是指示牌先动的手啊！</p>
<h2 id="崇善寺">崇善寺</h2>
<blockquote>
<p>崇善寺建于唐代初，初名白马寺，后改为延寿寺、宗善寺，明代时改为崇善寺。明洪武14年时，朱元璋的三儿仔朱棢为几年孝慈高皇后马氏，将寺院扩建。清同治3年，寺院失火，主要建筑均被毁，留下来的只有大悲殿及一些附属建筑清光绪7年，山西巡抚张之洞在废墟上建造文庙，崇善寺从此一分为二，现寺庙只占原有面积的40分之1大、</p>
</blockquote>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/06/22/5d0dbecfd54d452721.jpg" alt="崇善寺" loading="lazy"></figure>
<p>虽然进去寺庙以后发现崇善寺其实十分小，但处处透露着厚重的历史感。刚好当天还在庆祝佛诞，僧人与信众都在念梁王宝忏，让我想起很多年前的光孝寺。</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/06/22/5d0dc13903e2d36337.jpg" alt="猫咪听念经" loading="lazy"></figure>
<p>大悲殿外信徒诚心参拜，一树之隔，猫咪旁听，似懂非懂。</p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/06/22/5d0dc033391e352519.jpg" alt="钟" loading="lazy"></figure>
<p>在寺里溜达的时候发现了一口古老的大钟，回来后查了一下，发现钟鼓楼为明代创建，楼悬大钟为明代正德元年(1506年)铸造，通高两米，外径1．8米，传说重9999斤。</p>
<figure data-type="image" tabindex="5"><img src="https://i.loli.net/2019/06/22/5d0dc0aaf37ac90377.jpg" alt="暗中观察喵" loading="lazy"></figure>
<p>在爬上钟楼时还看到一只猫在暗中观察我，甚是可爱。</p>
<figure data-type="image" tabindex="6"><img src="https://i.loli.net/2019/06/22/5d0dc1e607dc949404.jpg" alt="草长屋顶啦" loading="lazy"></figure>
<p>在往回走时，看了一眼大殿屋檐，发现长出了枝芽，让我想到一个词：枯木逢生。</p>
<p>看到这大殿屋檐如此古旧，回来后又查了一番，发现大殿大至梁架，小至门窗都未更换，基本还是明代初修的遗物。想用很多词去形容，但了最后出口的只一句：真的是太好看了。</p>
<figure data-type="image" tabindex="7"><img src="https://i.loli.net/2019/06/24/5d1000097a79d41131.jpg" alt="晋源神景" loading="lazy"></figure>
<p>返回门口的时候回头看到了<strong>晋源神景</strong>四个字，于是又再查了一下，发现了崇善寺真的十分了不起：崇善寺自明代设僧纲司以来，又是掌管山西省佛教事务的机关，至今仍是山西省佛教协会的所在地。</p>
<figure data-type="image" tabindex="8"><img src="https://i.loli.net/2019/06/24/5d100004969bb57259.jpg" alt="" loading="lazy"></figure>
<p>再补充点小历史：</p>
<blockquote>
<p>大悲殿又是我国著名的佛教藏经收藏地，它以收藏宏富、版本珍稀而闻名于世。据统计，殿中现存自宋代以来的各种刻印、抄写的经书达3万余卷，其中仅宋、元、明的经书就达2．1万卷，而且保存完整，这在全国都是罕见的。</p>
<p>就其收藏种类而言，从北宋到南宋、元、明、清、民国和建国以来的各种藏经都有收藏，几乎包罗了我国木版印刷藏经以来的各种重要版本。就其价值而言，其中不乏名贵版本，特别是宋版藏经。</p>
<p>如北宋时期刻印《崇宁万寿藏》，印本为折本式，天地宽广，疏密得当，刻工精良，是难得一见的珍本。</p>
<p>另一收藏珍品是南宋的《碛砂藏》，其始刻于南宋绍定四年(1231年)，直至元代至治二年(1322年)才全部刻完，共有591函，6362卷。大悲殿现存《碛砂藏》共有562函，4846卷，仅缺29函，1716卷。</p>
<p>其它还有元代《普宁藏》、明代《南藏》、《北藏》、《武林藏&gt;&gt;、清拓泰山经石峪《金刚般若经》、明代金书《华严经6、明代血书《华严经》等等。这批历代刻印、抄写、拓印的各种佛教经典是我国珍贵的佛教文化遗产，也是研究我国古代哲学、文学、书法、印刷术的历史文物。</p>
</blockquote>
<h2 id="文庙">文庙</h2>
<p>由张之洞着力在崇善寺废墟上创建的文庙，就在崇善寺隔壁的一条小巷里。一路走过去时不知道，还绕着外面的马路走了一圈，在路上看到了一堵堵红墙与木门。</p>
<figure data-type="image" tabindex="9"><img src="https://i.loli.net/2019/06/24/5d100007c749430596.jpg" alt="" loading="lazy"></figure>
<p>不知道是不是地区原因，在崇善寺附近居住的人都十分地慢节奏，走在路上手上必定有菩提串又抑或是拿着两核桃。让我第一次真真切切地感受到那些小说上写着的的文化味。</p>
<figure data-type="image" tabindex="10"><img src="https://i.loli.net/2019/06/24/5d1000081426538371.jpg" alt="" loading="lazy"></figure>
<p>一开始对这个民俗博物馆感兴趣仅仅因为在马蜂窝上看到，在马蜂窝上它被评为最有性格的博物馆：经常性爱开不开。</p>
<p>于是带着好奇心，就一路找了过来。然后发现：**果然没开：）**果然我不是天选之人，遇不上它开门的时候。</p>
<figure data-type="image" tabindex="11"><img src="https://i.loli.net/2019/06/24/5d100008acde950097.jpg" alt="" loading="lazy"></figure>
<p>再往前走了两步，才发现这里有一座文庙，已经被纳为民俗博物院的一部分。由于之后没时间再来参观，特意又在找了一下资料。在宜宾客2015撰写的博客上记载道：</p>
<blockquote>
<p>国朝新立后，这里成为山西博物馆的一部，二部则是起凤街的纯阳宫。那时文庙展出的好像都是革命性的，纯阳宫则是历史性的东西，小学时，老师老领着我们参观，接受伟光正教育。如今山西博物院已在河西建了现代化大馆，文庙改成了“山西艺术博物馆”，纯阳宫则转型成“山西民俗博物馆”，虽都冠以“博物馆”名号，但无一免费。</p>
</blockquote>
<p>让人十分吃惊的是民俗博物馆的原身竟然是纯阳宫，但现在现在已与文庙纳为一块。儒家与道家的相结合，艺术与民俗的相结合，真真有意思。同时也印证了宜宾客在博客上所写的：<strong>历史都是过程，完美和缺陷都无法假设</strong>。我们现在很难知道当时纯阳宫是如何建在了崇善寺的废墟上，也不知道在这过程中几个宗教的地位进行了几次变更。</p>
<p>仅仅在外面拍了张游客照，就打道回火车站了。</p>
<h2 id="大同">大同</h2>
<figure data-type="image" tabindex="12"><img src="https://i.loli.net/2019/06/24/5d1024b589ab674995.jpg" alt="大同火车站" loading="lazy"></figure>
<p>坐了4个多小时的火车终于到达的大同火车站。在火车上我还在群里一脸懵逼的说：为什么现在的火车座位是面对面的，真心逼死强迫症。还被吐槽说我不知人间疾苦，出门只坐飞机。</p>
<p>坐在火车上想起好久以前坐绿皮火车去凤凰的情景，那时的绿皮火车还是开窗的。由于是长途火车，一路上人挤人，各种泡面味啥都有；害怕路上被透东西，眼睛也不敢闭。</p>
<p>到了大同以后拉着箱子出来，果然不同的火车站，同样热情的的士司机。马路上都是的士司机拉客打车的，随便选了一个15块到客栈。司机还拉了两个在大同读书的小姑娘，听着两人的对话真好玩。</p>
<figure data-type="image" tabindex="13"><img src="https://i.loli.net/2019/06/24/5d10273b1257e19306.jpg" alt="钟楼" loading="lazy"></figure>
<p>最后由于仿古街是步行街的缘故，的士司机在钟楼隔壁就停下了。我拉着箱子在昏暗的街灯下晃悠着去找客栈。</p>
<p>这间客栈的名字叫琵琶老店客栈，感觉那位招待的阿姨真真的是太好了，人也热情给我指点了一下附近有啥吃的，还会在我晚上出去晃悠的时候让我早点回来。除了热水器有点神经病以外没啥毛病。</p>
<p>晚饭随便搜了一间兔头店尝试了一下。EMMM 兔头没啥肉，不晓得为啥受欢迎，喝了瓶贵价啤酒……只能说我大概还是适合吃点实惠点的吧……嗝</p>
<p>在去大同的路上在马蜂窝订了个散团，吃饱喝足就洗洗睡准备明天6点30集合了。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Aga Khan Meseum]]></title>
        <id>https://gilgamel.github.io/post/aga-khan-meseum/</id>
        <link href="https://gilgamel.github.io/post/aga-khan-meseum/">
        </link>
        <updated>2019-04-13T02:38:36.000Z</updated>
        <content type="html"><![CDATA[<p>最近经常在INS看到 Aga Khan Meseum （AKM）关于人类登月50周年纪念而设的特展推广，于是就趁着周末跑去刷了一次馆。学生票 $12刀，外加导游讲解 $5，一共 $17。买完票的一瞬间觉得作为一个学生真的是太幸福了。</p>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/04/15/5cb3c9be67c57.jpg" alt="" loading="lazy"></figure>
<p>去到的时候大概1点，特展导游讲解在1点45开始。所以就趁这段时间在CAFE买了点喝的顺手再翻了一下博物馆的相关情况。</p>
<blockquote>
<p><strong>Aga Khan Meseum</strong></p>
<p>阿迦汗博物馆成立于2014年，，属于伊斯兰教什叶派伊斯玛仪派领袖阿迦汗四世（Prince Shah Karim Al Husseini）的私人财产。馆内藏品涵盖伊斯兰艺术、伊朗艺术和穆斯林文化等，重要展品包括伊本·西那（Ibn Sina）的《医典》副本、一张「蓝色古兰经」的书页、14世纪西班牙星盘等。</p>
</blockquote>
<p>阿迦汗博物馆的主体建筑于1996年由阿迦汗四世购得。2002年阿迦汗四世买下相邻建筑，并宣布建造阿迦汗博物馆、伊斯兰中心和阿迦汗公园。</p>
<p>2014年9月，阿迦汗博物馆正式开馆，这座博物馆由普利兹克建筑奖获得者、日本建筑师槙文彦（Fumihiko Maki）设计，占地面积约1万平方米。</p>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/04/15/5cb40b5d39958.jpg" alt="" loading="lazy"></figure>
<p>照例先给好久没出现的皮皮瘦来一张照片，右上角的一张 moon lady 很重要，导游还特意带我们到 moon lady 的展品上好好讲解了一番。</p>
<p>博物馆分为两层，楼上二楼为特展 The Moon，一楼为永久展区。</p>
<h3 id="the-moon-a-voyage-through-time">The Moon: A Voyage Through Time</h3>
<p>The Moon 这个展览利用了灯效，在地面上映射出上弦月、半月、满月的灯光效果，在一开始的时候用巨幅照片给游客展览了月亮的各个形态；并且将从月球上掉落的一小片陨石放在地面，放上透明玻璃罩，利用“站在过月球上”作为噱头，作为一个开头特色亮点。</p>
<p>随后真真正正进入展区后则通过艺术、文化等方面讲述伊斯兰文明与月亮的关联。</p>
<p>例如：在一副画上描画着蔬果、以及阁楼，在阁楼的顶部有一名占星师对月观察，看是否已经到了蔬果丰收、可以进食的日子。</p>
<p>又例如在伊斯兰文字里一个像月亮的图案则代表眼睛，而两两结合则代表不知道什么（。 而后两两结合成一个疑似满月的图案，上面除了文字以外，还有着经纬度。从这里可以看出，在当时的伊斯兰文明来说并没有宗教、科学之分。</p>
<p>除此以外让人印象深刻的是一个叫Astrolabe 的东西。</p>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/04/15/5cb4119dda2eb.jpg" alt="" loading="lazy"></figure>
<p>Astrolabe，又称为星盘，最早来源自希腊，是平面球与窥管的结合。窥管，（希腊语：διόπτρα）是可以追溯到公元前三世纪的传统]天文和测量工具。窥管是一根两端都可以看或是固定的观测管，如果装有量角器，就可以用来测量角度。</p>
<p>星盘在中世纪伊斯兰世界进一步发展，穆斯林天文学家在设计中引入了角度尺，在地平线上添加了指示方位角的圆圈。它在整个穆斯林世界被广泛使用，主要是作为航行的辅助手段，以及寻找麦加方向的朝拜方式。八世纪的数学家Muhammad al-Fazari是第一个在伊斯兰世界建造星盘的人。</p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/04/21/5cbbc7db37777.jpg" alt="" loading="lazy"></figure>
<p>星盘正反面均可使用，不仅能用来观星，还能用来看时间（真的感觉很牛逼了），在看到星盘的第一眼不知道为什么首先想到了中国的日晷；大概是因为两个物品有着一些些相同之处吧。除此以外星盘让人感觉到印象深刻的原因大概是源于现代人对于伊斯兰文明、穆斯林的stereotype。当我们想到中东、伊斯兰、穆斯林的时候第一反应想到的是绿绿，却忘了其实在很多年前伊斯兰文明有多棒。</p>
<h3 id="the-permanent-exhibition">The  Permanent Exhibition</h3>
<figure data-type="image" tabindex="5"><img src="https://i.loli.net/2019/04/19/5cb95907c36e2.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p>This selection of jewelery has been lavishly ornamented using filigree and granulation, displaying the intricate and demanding goldsmithing techniques that showcase the skill and sophistication of craftsmanship during the Fatimid dynasty (973 - 1171).</p>
<p>The gold jewellery of the Fatmids was well-known in its time, and was linked to the luxurious objects of the Byzantine Empire (ca. 330 - 1453), reflecting the importance of the relationship between the two cultures.</p>
<p>From Cairo, the cosmopolitan capital they founded, the Fatimids traded commodities, skills, and ideas across and extensive commercial network that reached from the Mediterranean into Africa and across the Read Sea and the Indian Ocean to China.</p>
</blockquote>
<p>在伊斯兰文明中的首饰多数与月亮相关，且非常精致。即使中国古代的首饰里不乏制作异常精致的首饰，但是两者给人的感觉完全不同。如果需要用很粗暴的语言去描述两者的区别，那大概是中国古代的首饰精致中带着大气与写意，而伊斯兰文明的首饰则是精致中带着刻进骨子里的严谨（强迫）。事实上在博物馆看到的不管首饰、书籍、又抑或是瓷器，都带着让强迫症极度舒适的对称形状。</p>
<figure data-type="image" tabindex="6"><img src="https://i.loli.net/2019/04/21/5cbb97641ccf3.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p><strong>Tiraz Textile</strong></p>
<p>Damietta, Egypt, 411 AH/ 1021</p>
<p>Linen, with silk tapestry-woven inscription</p>
<p>This tiraz fragment was made during the reign of Caliph al-Hakim (r. 996 - 1021), the sixth ruler of the Fatimid Dynasty. The fine quality of the weave is an indication that this is a luxury fabric. The bold kufic inscription is tapestry-woven in undyed linen against a blue ground with yellow tendrils floating above the letters.</p>
<p>The fragment is an excellent example that illustrates the historical importance of tiraz textiles. It contains the name of the Caliph, the last year of his reign, as well as the name of the factory, the city, and the date that it was made.</p>
</blockquote>
<p>伊斯兰文明时代的人似乎认为文字是非常神圣的东西，所以他们会在所有绣品、瓷砖等等都绣上、印上文字，就像中国古代人民会在瓷器、墙砖上放各种祥云纹又或许一些其他的图案。</p>
<p>而上面这张图是一块 <strong>Tiraz</strong>，直接英译中大概叫提拉兹；是中世纪的伊斯兰刺绣，通常会以臂章的形式封在荣誉长袍上（khilat）。就像博物馆的展品描述所说的一样： tiraz 会被用于授予表现出对哈里发（Caliph）忠诚的高级官员，以及会被作为礼物送给某些身份极其尊贵的人。 Tiraz 上通常会绣有统治者的名字，有贵重的金属线，有复杂的图案；它是一种权力的象征，生产和出口都会受到严格监管，并由政府任命的官员进行监督。</p>
<figure data-type="image" tabindex="7"><img src="https://i.loli.net/2019/04/21/5cbbc158e3089.jpg" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="8"><img src="https://i.loli.net/2019/04/21/5cbbc24871152.jpg" alt="" loading="lazy"></figure>
<p>相传颈长而细的瓶子都是用来存放比较重要的液体，同时也方便倒出。两张图片中的右侧瓶子都同属一个类型。特别是跟青色琉璃瓶的制式有8成相似，可惜这个瓶子的瓶颈处细节看得不大清楚</p>
<figure data-type="image" tabindex="9"><img src="https://i.loli.net/2019/04/21/5cbbc2490a3a6.jpg" alt="" loading="lazy"></figure>
<p>而这个钟同样印证了伊斯兰文明时代的人对文字十分看中，所以会喜欢将文字放在不同的器具上这么一个说法。与此同时，他们非常喜欢在器具上作花以及鸟的图案。如果将这个钟的图片放大则可以看到字体之间的图案便是花。</p>
<figure data-type="image" tabindex="10"><img src="https://i.loli.net/2019/04/21/5cbbc3a584fbe.jpg" alt="" loading="lazy"></figure>
<p>不知道是什么年代的花瓶（热水瓶？？？），花纹上是典型的伊斯兰文明风格，但是从颜色上却让人想到了中国的青花瓷</p>
<figure data-type="image" tabindex="11"><img src="https://i.loli.net/2019/04/21/5cbbc249367a5.jpg" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="12"><img src="https://i.loli.net/2019/04/21/5cbbc7db221e3.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p><strong>Oliphant</strong></p>
<p>Oliphant: Sicily, Italy, 12th century. Ivory, carved</p>
<p>Mount: England, 17th century. Silver, moulded and engraved</p>
<p>Ivory hunting horns, or oliphants, were made between the mid-eleventh to the thirteenth centuries and are exquisite examples of cultural exchange between Muslim and Christian societies in the Mediterranean world.</p>
<p>The size of this oliphant, its richly carved figurative decoration, and its excellent condition are suggestive of a ceremonial function in courtly societies, associated with the hunt, combat, and banquets.</p>
</blockquote>
<p>这个象牙雕保存情况十分好，被推断为是用作庆典用途的物品。大概人们在出去打猎、战斗、大型宴会前都会用到它。从装饰上看，银制的鹰爪从某些程度上代表了图腾文化。而雕刻的形状也十分写实而有规律感。</p>
<figure data-type="image" tabindex="13"><img src="https://i.loli.net/2019/04/21/5cbbca6768a71.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p><strong>Iran</strong></p>
<p>circa 1150 - 1500</p>
<p>A distinctive feature of Iranian art in this period is the use of ever more complex patterns, whether in the art of the book or on bronzes. A parallel evolution takes place in Persian literature, which saw the images and metaphors of poetry become richer, even arcane, and the development of &quot;ornate prose&quot; (nasr-e mozayyan).</p>
<p>Painting undergoes a metamorphosis between the 1250s and the 1350s. Archetypal figures, such as those painted in polychromy or in golden (&quot;lustre&quot;) colors on thirteenth-century pottery, give way to narrative scenes.</p>
<p>Persian poetry, common on certain categories of thirteenth-century pottery, is systematically used on metal vessels from the mid-fifteenth century on. By contrast, Arabic almost entirely disappeared from objects not destined for shrines or warfare.</p>
</blockquote>
<p>在这一时期，伊朗艺术的一个显着特征是使用更复杂的图案，无论是在书籍的艺术中还是在青铜器上。 在波斯文学中发生了一种平行的演变，其中诗歌的图像和隐喻变得更加丰富，甚至是神秘的，并且发展了“华丽的散文”（nasr-e mozayyan）。</p>
<p>绘画经历了1250年代和1350年代之间的变态。 原型人物，例如十三世纪陶器中的多色或金色（“光泽”）色彩，让位于叙事场景。</p>
<p>波斯诗歌，在十三世纪陶器的某些类别中很常见，系统地用于十五世纪中期的金属器皿上。 相比之下，阿拉伯语几乎完全从没有用于神社或战争的物体中消失。</p>
<hr>
<p>关于展品的相关内容就告一段落了。在补这篇游记的时候其实都处于一种一边Google，一边继续写的状态，却感觉学到了很多有意思的东西。</p>
<p>博物馆真的是一个十分美好的地方，大概也是现代人能够从中学习到历史文化最便捷的地方了。看再多的书，也必须看一眼失物去加以验证。</p>
<p>读万卷书不如行万里路。</p>
]]></content>
    </entry>
</feed>