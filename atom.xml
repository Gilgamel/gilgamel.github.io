<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://gilgamel.github.io</id>
    <title>Gilgamel&apos;s Notepad</title>
    <updated>2021-10-28T06:43:02.393Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://gilgamel.github.io"/>
    <link rel="self" href="https://gilgamel.github.io/atom.xml"/>
    <logo>https://gilgamel.github.io/images/avatar.png</logo>
    <icon>https://gilgamel.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Gilgamel&apos;s Notepad</rights>
    <entry>
        <title type="html"><![CDATA[[EXCEL DA] 用 Excel 进行时间、分类统计]]></title>
        <id>https://gilgamel.github.io/post/excel_da_001/</id>
        <link href="https://gilgamel.github.io/post/excel_da_001/">
        </link>
        <updated>2021-10-24T17:57:05.000Z</updated>
        <content type="html"><![CDATA[<h2 id="在分析过程中使用到的相关函数及功能">在分析过程中使用到的相关函数及功能</h2>
<ol>
<li>Pivottable</li>
<li>Split Cells</li>
<li>Date 函数</li>
<li>DATEDIF 函数</li>
<li>IF 函数</li>
</ol>
<h2 id="分析需求">分析需求</h2>
<p>根据要求，需要针对数据提供以下几项分析：</p>
<ul>
<li>Submit 时间分析：每个月的数据量，分析出来高峰期在什么时候</li>
<li>Shipment 时间分析：可以关注下 submit-shipment 直接的时间先后顺序 lead time</li>
<li>区域分析：区域数据量</li>
<li>患者年龄段：
<ul>
<li>genz：1997 之后</li>
<li>sophiscated：1986 - 1997 之间</li>
<li>senior：1986 之前</li>
</ul>
</li>
<li>客户性别比例</li>
<li>治疗步数分析：
<ul>
<li>20步</li>
<li>20-40</li>
<li>40-60</li>
<li>60以上</li>
</ul>
</li>
</ul>
</br>
<h2 id="excel-操作">EXCEL 操作</h2>
<h3 id="submit-date-时间分析">Submit Date 时间分析</h3>
<p>根据提供的算法，在 RAW DATA 里找到 submit date，并发现已提供了 <strong>submit year &amp; submit month</strong>，不需要再做任何的数据处理，直接即可应用</p>
<figure data-type="image" tabindex="1"><img src="https://gilgamel.github.io/post-images/1635392316886.png" alt="" loading="lazy"></figure>
<p><font color=LightSeaGreen> submit month value 每出现一次，则代表一次订单产生，因此要知道每个月的订单数量，只需要通过 pivottable 统计 submit month 出现的次数即可。</font></p>
<p>方法如下：</p>
<ol>
<li>选中 submit month &amp; submit year 两列</li>
<li>选择菜单栏上的 插入 → 数据透视表 （英文版则为 Insert → PivotTable）</li>
<li>弹出“来自表格或区域的数据透视表”框后，选择新工作表，然后点确定 （见下图）<br>
<img src="https://gilgamel.github.io/post-images/1635392984103.png" alt="" loading="lazy"></li>
<li>在新建工作表上点击“数据透视表”，右侧会出现数据透视表字段，将 submit year &amp; submit month 拖拽到相应位置即可<br>
<img src="https://gilgamel.github.io/post-images/1635393091985.png" alt="" loading="lazy"></li>
<li>此时新的工作表上即出现了关于 submit date 的相关统计数据</li>
</ol>
</br>
<h3 id="shipment-date-时间分析">Shipment Date 时间分析</h3>
<p>根据提出的需求，关于 shipment date 的时间分析有两个方面：</p>
<ol>
<li>shipment 高峰期</li>
<li>submit date - shipment date 的间隔时间 （一般这方面的分析用于研究、衡量公司从接收到订单到出货的时间，从间距时间可以反映出公司内部的流程是否通顺，也可在精细化运营时使用。</li>
</ol>
<p>通过 DATEDIF 公式可以计算出两个日期的相差值</p>
<pre><code>DATEDIF(submit_date,shipment_date,&quot;d&quot;)

# d = day

</code></pre>
<figure data-type="image" tabindex="2"><img src="https://gilgamel.github.io/post-images/1635396999931.png" alt="" loading="lazy"></figure>
<h4 id="日期格式无法修改">日期格式无法修改</h4>
<p>针对修改格式但没反应的情况，在确认单元格已经去掉锁定后，<strong>用分列 → 合并的思路进行处理</strong>，具体操作如下；</p>
<ol>
<li>
<p>选择<strong>数据 → 分列</strong>，分隔符选其他，输入“-”，点击下一步<br>
<img src="https://gilgamel.github.io/post-images/1635399718240.png" alt="" loading="lazy"></p>
</li>
<li>
<p>列数据格式选择日期，并根据原有的日期格式选择 DMY，目标区域需要选择一个新的空列，然后选择完成<br>
<img src="https://gilgamel.github.io/post-images/1635399794604.png" alt="" loading="lazy"></p>
</li>
</ol>
<p>在这个部分处理时，我直接新建了3个空列，避免拆分出来的数据将其他已有数据覆盖掉。</p>
<ol start="3">
<li>通过 DATE 函数将拆分出来的日期重新合并。<br>
<img src="https://gilgamel.github.io/post-images/1635399883980.png" alt="" loading="lazy"></li>
</ol>
</br>
<h3 id="区域分析-患者性别比例分析">区域分析、患者性别比例分析</h3>
<p>这两个部分由于不需要针对数据进行处理，直接插入 pivottable 进行统计即可，方法跟 submit date 部分一样。</p>
</br>
<h3 id="患者年龄段">患者年龄段</h3>
<p>根据需求需要将所有客户的年龄分为 3 个种类：<br>
- genz：1997 之后<br>
- sophiscated：1986 - 1997 之间<br>
- senior：1986 之前</p>
<p>由于 RAW DATE 里客户出生日期是具体到天的，因此需要将出生年份拆分出来。<br>
这个时候可以直接<strong>用 RIGHT 函数选取客户出生日期的后 4 位。</strong></p>
<p><img src="https://gilgamel.github.io/post-images/1635400640771.png" alt="" loading="lazy"><br>
<strong>记得将公式值复制黏贴为数字格式</strong></p>
<p>之后可以用 IF 函数对客户的出生年份进行判断，即：</p>
<ul>
<li>genz：x &gt; 1997 （因为在1997之后出生的日期，如 1998、1999 均大于 1997）</li>
<li>sophiscated： 1986 &lt; x &lt; 1997</li>
<li>senior：x &lt; 1986 （在1986之前出生的日期，加 1985、1984 均小于 1986）</li>
</ul>
<p>由于判断条件有3个，因此需要用 IF 函数进行套娃，而 IF 函数是采取递进关系的，因此年龄的判断先后 MATTERS。</p>
<pre><code>=IF(X&gt;1997,&quot;genz&quot;,IF(X&gt;1985,&quot;sophiscated&quot;,&quot;senior&quot;))

# 如果 X &gt; 1997，将它命名为 genz；
# 否则如果 X &gt; 1985，将它命名为 sophiscated；
# 否则则将它命名为 senior
</code></pre>
<p><strong>因为 RAW DATA 中有少量 null 值，在分类后复制黏贴值以后直接将关于 null 的错误种类手动修改，避免疯狂使用 IF函数进行套娃出现错误。</strong></p>
<p>分类完成后使用 pivottable 进行统计即可。</p>
</br>
<h3 id="治疗步数分析">治疗步数分析</h3>
<p><strong>已知：</strong></p>
<ol>
<li>步数后面是单颌，需要*2=上下颌才是整体步数</li>
<li>RAW DATA 中有上下颌分类说明</li>
<li>RAW DATA 中的步数为单颌步数 （即非完整步数）</li>
</ol>
<p><strong>所以：</strong></p>
<ol>
<li>需要将整体的步数通过上下颌计算出来</li>
<li>针对完整步数对步数进行分类</li>
</ol>
<h4 id="计算整体步数">计算整体步数</h4>
<p>通过 IF 函数将上下颌列为筛选条件：</p>
<pre><code>=IF(X=&quot;BOTH&quot;,X*2,X)

# 如果是 BOTH，则步数*2，否则则保持原样
</code></pre>
<p><strong>随后将函数值复制黏贴为值即可针对整体步数进行分类。</strong></p>
<p>根据需求可以将分类逻辑整理如下：<br>
- 20及以下：x &lt; 20<br>
- 20-40：19 &lt; x &lt; 41<br>
- 40-60：39 &lt; x &lt; 61<br>
- 60以上：x &gt; 60</p>
<p>再通过 IF 函数疯狂套娃：</p>
<pre><code>=IF(X&gt;60,&quot;60以上&quot;,IF(X&gt;39,&quot;40-60&quot;,IF(X&gt;19,&quot;20-40&quot;,&quot;20及以下&quot;)))

# 如果 X &gt; 60，则将它命名为 60以上
# 如果 X &gt; 39，则将它命名为 40 - 60
# 如果 X &gt; 19， 则将它命名为 20 - 40
# 否则将名为 20及以下
</code></pre>
<p>同理最后复制黏贴值后，将 null 值手动替换则完成所有分类<br>
最后再通过 pitvottable 统计即可。</p>
</br>
<h2 id="ref">Ref</h2>
<blockquote>
<p>https://support.microsoft.com/en-us/office/datedif-function-25dba1a4-2812-480b-84dd-8b32a451b35c<br>
https://support.microsoft.com/zh-cn/office/date-%E5%87%BD%E6%95%B0-e36c0c8c-4104-49da-ab83-82328b832349</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Advanced Google Analytics Assessment 2]]></title>
        <id>https://gilgamel.github.io/post/advanced-google-analytics-assessment-2/</id>
        <link href="https://gilgamel.github.io/post/advanced-google-analytics-assessment-2/">
        </link>
        <updated>2021-10-04T00:26:35.000Z</updated>
        <content type="html"><![CDATA[<h2 id="notes">Notes</h2>
<p>limits of numbers of custom dimensions</p>
<ul>
<li>stadnard: 20</li>
<li>analytics 360: 200</li>
</ul>
<h2 id="ref">Ref</h2>
<p>https://support.google.com/analytics/answer/7165564?hl=en</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Advanced Google Analytics Assessment 1]]></title>
        <id>https://gilgamel.github.io/post/advanced-google-analytics-assessment-1/</id>
        <link href="https://gilgamel.github.io/post/advanced-google-analytics-assessment-1/">
        </link>
        <updated>2021-10-01T17:08:05.000Z</updated>
        <content type="html"><![CDATA[<h2 id="assessment">Assessment</h2>
<ol>
<li>If default Google Analytics tracking code is installed on pages with different domains, Analytics will count these users and sessions separately.</li>
</ol>
<ul>
<li><mark>True</mark></li>
<li>False</li>
</ul>
<ol start="2">
<li>What does Google Analytics call a URL that passes data parameters for reporting?</li>
</ol>
<ul>
<li>A tag</li>
<li><mark>A hit</mark></li>
<li>A dimension</li>
<li>A metric</li>
</ul>
<ol start="3">
<li>When does the Google Analytics tracking code send a pageview hit to Analytics?</li>
</ol>
<ul>
<li>Every time a user clicks a video</li>
<li>Every time a user adds an item to a shopping cart</li>
<li>Every time a user performs a search on a website</li>
<li><mark>Every time a user loads a webpage</mark></li>
</ul>
<ol start="4">
<li>When does the Google Analytics tracking code send an event hit to Analytics?</li>
</ol>
<ul>
<li>Every time a user performs an action with pageview tracking</li>
<li>Every time a user makes a reservation on a booking site</li>
<li>Every time a user adds an event to their calendar</li>
<li><mark>Every time a user performs an action with event tracking</mark></li>
</ul>
<ol start="5">
<li>What does Google Analytics use to differentiate new and returning users?</li>
</ol>
<ul>
<li><mark>A browser cookie</mark></li>
<li>Artificial intelligence</li>
<li><mark>A randomly-assigned unique identifier</mark></li>
<li>A sequential unique identifier</li>
</ul>
<ol start="6">
<li>What will happen if a user clears the Analytics cookie from their browser?</li>
</ol>
<ul>
<li>Analytics will inform the user that they need to set a new Analytics cookie</li>
<li><mark>Analytics will not be able to associate user behavior data with past data collected by the tracking code</mark></li>
<li><mark>Analytics will set a new unique ID and browser cookie the next time a browser loads a tracked page</mark></li>
<li>Analytics will automatically recognize returning users</li>
</ul>
<ol start="7">
<li>By default, Google Analytics can recognize returning users over multiple sessions from different browsers and devices.</li>
</ol>
<ul>
<li>True</li>
<li><mark>False</mark></li>
</ul>
<ol start="8">
<li>A session in Google Analytics times out after how many minutes by default?</li>
</ol>
<ul>
<li>5</li>
<li>15</li>
<li><mark>30</mark></li>
<li>60</li>
</ul>
<ol start="9">
<li>To send data to Google Analytics from a web-connected device like a point-of-sale system, what feature must be used?</li>
</ol>
<ul>
<li>Data Import</li>
<li>Browser cookies</li>
<li>The Networking protocol</li>
<li><mark>The Measurement Protocol</mark></li>
</ul>
<ol start="10">
<li>For an event goal defined as playing a video, how many Goal conversions will Google Analytics record if that video is played three times in the same session?</li>
</ol>
<ul>
<li><mark>1</mark></li>
<li>2</li>
<li>3</li>
<li>4</li>
</ul>
<ol start="11">
<li>Which are Goal types in Google Analytics?</li>
</ol>
<ul>
<li><mark>Destination</mark></li>
<li>Shopping Cart</li>
<li><mark>Pages/Screens per session</mark></li>
<li><mark>Duration</mark></li>
</ul>
<ol start="12">
<li>If data is excluded from a view using a filter, it may be recovered within thirty days.</li>
</ol>
<ul>
<li>True</li>
<li><mark>False</mark></li>
</ul>
<ol start="13">
<li>Which of these scopes could be used for dimensions and metrics?</li>
</ol>
<ul>
<li>Event-level, session-level, or transaction-level scope</li>
<li>Location-level, duration-level, or user-level scope</li>
<li><mark>Hit-level, session-level, or user-level scope</mark></li>
<li>Event-level, duration-level, or transaction-level scope</li>
</ul>
<ol start="14">
<li>When defining a measurement plan, what is the order of steps?</li>
</ol>
<ul>
<li>Business objectives &gt; KPIs &gt; key actions</li>
<li>KPIs &gt; key actions &gt; business objectives</li>
<li>Key actions &gt; KPIs &gt; business objectives</li>
<li><mark>Business objectives &gt; key actions &gt; KPIs</mark></li>
</ul>
<ol start="15">
<li>What are macro-conversions in a measurement plan?</li>
</ol>
<ul>
<li>The metric data used to measure business success</li>
<li><mark>The main website actions users take that accomplish stated business goals</mark></li>
<li>The secondary website actions users take that lead to main actions</li>
<li>A list of keyboard shortcuts for measurement tasks in Google Analytics</li>
</ul>
<h2 id="note">Note</h2>
<p>Macro-conversions &amp; Micro-conversions</p>
<ul>
<li><strong>Macro-conversions:</strong> usually measure the tatics that support your various strategies</li>
<li><strong>Micro-conversions:</strong> are metrics that help you better understand the user behavior that leads to macro conversions.</li>
</ul>
<p>Dimensions and metrics can have one of three scopes:</p>
<ul>
<li>hit-level</li>
<li>session-level</li>
<li>user-level</li>
</ul>
<p>The three most common types of hits are:</p>
<ul>
<li><strong>&quot;pageview&quot; hits:</strong> A “pageview” hit is triggered when a user loads a webpage with the tracking code. This is the most common type of hit sent to Analytics. Every time a user opens a page with the tracking code, a new pageview hit will be sent.</li>
<li><strong>&quot;event&quot; hits:</strong> An “event” hit lets you track every time a user interacts with a particular element on your website. For example, you can track whether users click a video Play button, a particular URL, or a product carousel. <strong>Event hits pass four parameters of data in the URL: event action, category, label, and value.</strong> You can use these to categorize interactions in reports that are specific to your website. We’ll go into more detail on event tracking a little later.</li>
<li><strong>&quot;transcation&quot; hits:</strong> A “transaction” hit (also called an “ecommerce” hit) can pass data to Analytics about ecommerce purchases such as products purchased, transaction IDs, and “stock keeping units” (or SKUs).</li>
</ul>
<p>There are four types of Goals in Google Analytics:</p>
<ul>
<li><strong>Destination (or Pageview)</strong> Goals are based on when a user views a particular page on your website.</li>
<li><strong>Event Goals</strong> are when a particular action defined as an event is triggered.</li>
<li><strong>Duration Goals</strong> are based on sessions that last over a set amount of time.</li>
<li><strong>“Pages or Screens per Session” Goals</strong> are based on whether a user has viewed a set amount of pages in a session.</li>
</ul>
<p>REF:<br>
https://support.google.com/analytics/answer/7165155?hl=en</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Google Analytics for Beginners Assessment 4]]></title>
        <id>https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-4/</id>
        <link href="https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-4/">
        </link>
        <updated>2021-09-13T16:18:26.000Z</updated>
        <content type="html"><![CDATA[<h2 id="assessment">Assessment</h2>
<ol>
<li>Which three tags does Google Analytics require for accurate campaign tracking?</li>
</ol>
<ul>
<li>Medium, Source, and Content</li>
<li>Medium, Source, and Campaign</li>
<li><mark>Campaign, Content, and Term</mark></li>
<li>Source, Content, and Term</li>
</ul>
<ol start="2">
<li>Which tags are standard Google Analytics campaign parameters?</li>
</ol>
<ul>
<li>utm_adgroup</li>
<li><mark>utm_source</mark></li>
<li><mark>utm_medium</mark></li>
<li><mark>utm_content</mark></li>
</ul>
<ol start="3">
<li>To quickly generate campaign tags, what tool should be used?</li>
</ol>
<ul>
<li>The Measurement Protocol</li>
<li>The Segment Builder</li>
<li><mark>The URL Builder</mark></li>
<li>The Goal Selector</li>
</ul>
<ol start="4">
<li>Which formats may be used to add a custom campaign parameter to a URL?</li>
</ol>
<ul>
<li>www.googlemerchandisestore.com/?utm campaign = fallsale</li>
<li><mark>www.googlemerchandisestore.com/?utm_campaign=fallsale</mark></li>
<li><mark>www.googlemerchandisestore.com/?utm_campaign=fall_sale</mark></li>
<li>www.googlemerchandisestore.com/?utm_campaign = fall sale</li>
</ul>
<ol start="5">
<li>Which are examples of Goals in Google Analytics?</li>
</ol>
<ul>
<li><mark>Making a purchase</mark></li>
<li><mark>Signing up for a newsletter</mark></li>
<li>Completing a successful Google search</li>
<li><mark>Submitting a contact information form</mark></li>
</ul>
<ol start="6">
<li>When creating a Goal in Google Analytics, which are required?</li>
</ol>
<ul>
<li><mark>Goal Name</mark></li>
<li><mark>Goal Type</mark></li>
<li><mark>Goal Slot ID</mark></li>
<li>Goal Funnel Visualization</li>
</ul>
<ol start="7">
<li>If the Google Merchandise Store sets up a URL goal of “/thankyou” and a Match Type of “Begins with”, which of the following pages on www.googlemerchandisestore.com will count as goals?</li>
</ol>
<ul>
<li>/thankyou.html</li>
<li>/thankyou.php</li>
<li>/thankyou/receipt.php</li>
<li><mark>All of the above</mark></li>
</ul>
<ol start="8">
<li>Google Ads lets users advertise on which properties?</li>
</ol>
<ul>
<li><mark>Google Search</mark></li>
<li><mark>Google Display Network</mark></li>
<li>Campaign Manager</li>
<li>Google AdSense</li>
</ul>
<ol start="9">
<li>Enabling auto-tagging does what?</li>
</ol>
<ul>
<li>Adds Analytics tags to campaign URLs</li>
<li><mark>Adds Google Ads tags to campaign URLs</mark></li>
<li>Adds campaign hyperlinks to website pages</li>
<li>Adds Analytics tracking code to website pages</li>
</ul>
<ol start="10">
<li>What Google Ads report in Google Analytics can show which bid adjustments resulted in higher conversions?</li>
</ol>
<ul>
<li>Campaigns</li>
<li>Keywords</li>
<li><mark>Bid Adjustments</mark></li>
<li>Destination URLs</li>
</ul>
<h2 id="note">Note</h2>
<p>There are five different campaign tags that help you identify specific information about your campaign traffic. Medium, Source, and Campaign are required campaign tags. You can also add tags for Content and Term.</p>
<ul>
<li><strong>&quot;Medium&quot;</strong> communicates the mechanism, or how you sent your message to the user. You could include “email” for an email campaign, “cpc” for paid search ads, or “social” for a social network.</li>
<li><strong>“Source”</strong> communicates where the user came from. This could be a specific web page or a link in an email. Source could also differentiate the type of medium. So if the medium was “cpc” (or “cost per click” paid traffic), the source might be “google,” “bing,” or “yahoo.” If the medium was “email,” the source might be “newsletter”.</li>
<li><strong>“Campaign”</strong> can communicate the name of your marketing campaign such as “2015-Back-To-School” or “2015-Holiday-Sale”.</li>
<li><strong>“Content”</strong> can be used to differentiate versions of a promotion. This is useful when you want to test which version of an ad or promotion is more effective. If you’re running a test between two different versions of a newsletter, you might want to label these tags “v1-10dollars-off” and “v2-nopromo” to help differentiate which newsletter the data is associated with in Google Analytics.</li>
<li><strong>“Term”</strong> is used to identify the keyword for paid search campaigns. You would only use this field if you are manually tagging a paid search campaign like Bing or Yahoo!. We’ll talk about the best way to track Google Ads in a later lesson.</li>
</ul>
</br>
Distinction between two types of goals: business goads and Google Analytic Goals.
<ul>
<li><strong>Business goals</strong> are actions you want your user to take on your website. Each time a user completes one of your business goals, we call this a “conversion.” This could be signing up for a newsletter or buying a product.</li>
<li></li>
</ul>
<p>REF:<br>
https://support.google.com/analytics/answer/6383005?hl=en<br>
https://support.google.com/analytics/answer/6383000?hl=en</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Google Analytics for Beginners Assessment 3]]></title>
        <id>https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-3/</id>
        <link href="https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-3/">
        </link>
        <updated>2021-09-13T14:37:36.000Z</updated>
        <content type="html"><![CDATA[<ol>
<li>What setting must be enabled to view data in Demographics and Interests Reports?</li>
</ol>
<ul>
<li>Content Grouping</li>
<li><mark>Advertising features</mark></li>
<li>User permissions on the view</li>
<li>In-Page Analytics</li>
</ul>
<ol start="2">
<li>What report would best help identify potential browser issues with website traffic?</li>
</ol>
<ul>
<li>The Active Users report</li>
<li>The New vs Returning report</li>
<li><mark>The Browser &amp; OS report</mark></li>
<li>The Source/Medium report</li>
</ul>
<ol start="3">
<li>What report shows what mobile devices were used to view a website?</li>
</ol>
<ul>
<li>The Exit Pages report under “Site Content”</li>
<li>The Landing Page report under “Site Content”</li>
<li>The Engagement report under “Behavior”</li>
<li><mark>The Devices report under “Mobile”</mark></li>
</ul>
<ol start="4">
<li>Which Traffic Source dimensions does Google Analytics automatically capture for each user who comes to your site?</li>
</ol>
<ul>
<li>Source, Keyword, Campaign name</li>
<li>Source, Medium, Keyword</li>
<li><mark>Source, Medium, Campaign name</mark></li>
<li>Medium, Keyword, Campaign name</li>
</ul>
<ol start="5">
<li>Which “sources” are available in Google Analytics?</li>
</ol>
<ul>
<li><mark>googlemerchandisestore.com</li>
<li>Email</li>
<li><mark>Google</li>
<li><mark>(direct)</li>
</ul>
<blockquote>
<p>** Traffic source dimensions**</p>
<p><strong>Source</strong>: Every referral to a web site has an origin, or source. Possible &gt; sources include: “google” (the name of a search engine), “facebook.com” (the name of a referring site), “spring_newsletter” (the name of one of your newsletters), and “direct” (users that typed your URL directly into their browser, or who had bookmarked your site).</p>
<p><strong>Medium</strong>: Every referral to a website also has a medium. Possible medium include: “organic” (unpaid search), “cpc” (cost per click, i.e. paid search), “referral” (referral), “email” (the name of a custom medium you have created), “none” (direct traffic has a medium of “none”).</p>
<p><strong>Keyword</strong>: When SSL search is employed, Keyword will have the value (not provided).</p>
<p><strong>Campaign</strong> is the name of the referring Google Ads campaign or a custom campaign that you have created.</p>
<p><strong>Content identifies a specific link or content item in a custom campaign.</strong><br>
For example, if you have two call-to-action links within the same email message, you can use different Content values to differentiate them so that you can tell which version is most effective.</p>
</blockquote>
<p>Ref: https://support.google.com/analytics/answer/1033173?hl=en</p>
<ol>
<li>Which “mediums” are available in Google Analytics?</li>
</ol>
<ul>
<li><mark>organic</mark></li>
<li><mark>cpc</mark></li>
<li>mail.google.com</li>
<li><mark>referral</mark></li>
</ul>
<ol start="7">
<li>Which &quot;channels&quot; are available in the default Channels report?</li>
</ol>
<ul>
<li><mark>Organic Search</mark></li>
<li>Device</li>
<li><mark>Display</mark></li>
<li><mark>Direct</mark></li>
</ul>
<ol start="8">
<li>What report can show how particular sections of website content performed?</li>
</ol>
<ul>
<li>Location</li>
<li><mark>Content Drilldown</mark></li>
<li>Frequency and Recency</li>
<li>Top Events</li>
</ul>
<ol start="9">
<li>What report lists the website pages where users first arrived?</li>
</ol>
<ul>
<li>Events &gt; Pages</li>
<li>All Pages</li>
<li>Exit Pages</li>
<li><mark>Landing Pages</mark></li>
</ul>
<ol start="10">
<li>What report should be used to check if users are leaving from important pages on your website?</li>
</ol>
<ul>
<li>Landing Pages report</li>
<li>All Pages report</li>
<li><mark>Exit Pages report</mark></li>
<li>Pages report under Events</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Google Analytics for Beginners Assessment 2]]></title>
        <id>https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-2/</id>
        <link href="https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-2/">
        </link>
        <updated>2021-09-13T11:45:11.000Z</updated>
        <content type="html"><![CDATA[<h2 id="assessment2">Assessment2</h2>
<ol>
<li>What feature would be used to compare two date ranges in a report?</li>
</ol>
<ul>
<li>Hourly, Day, Week, Month views in the time graph</li>
<li>Real-time reports</li>
<li><mark>Date range comparison</mark></li>
<li>Account selector</li>
</ul>
<ol start="2">
<li>What does the “Users” metric measure?</li>
</ol>
<ul>
<li>The total number of visits to your website</li>
<li><mark>Users that had at least one session on your site in the given date range</mark></li>
<li>Users that landed on the homepage of your website</li>
<li>Users who have signed up to an email newsletter on your website</li>
</ul>
<ol start="3">
<li>What is the “Bounce Rate” in Google Analytics?</li>
</ol>
<ul>
<li>The number of times unique users returned to your website in a given time period</li>
<li>The percentage of sessions in which a user exits from your homepage</li>
<li>The percentage of total site exits</li>
<li><mark>The percentage of visits when a user landed on your website and exited without any interactions</mark></li>
</ul>
<ol start="4">
<li>What is a “dimension” in Google Analytics?</li>
</ol>
<ul>
<li>The total amount of revenue a business has made in a given date range.</li>
<li><mark>An attribute of a data set that can be organized for better analysis.</mark></li>
<li>A comparison of data between two date ranges.</li>
<li>A report that offers information about your audience.</li>
</ul>
<ol start="5">
<li>What is a “metric” in Google Analytics?</li>
</ol>
<ul>
<li>A dimension that can help you analyze site performance.</li>
<li>The dates in your date range.</li>
<li>A segment of data separated out in a report for comparison.</li>
<li><mark>The numbers in a data set often paired with dimensions.</mark></li>
</ul>
<ol start="6">
<li>What is a “secondary dimension” in Google Analytics?</li>
</ol>
<ul>
<li>An additional widget you can add to a dashboard for more specific analysis.</li>
<li>An additional metric you can add to a report for more specific analysis.</li>
<li><mark>An additional dimension you can add to a report for more specific analysis.</mark></li>
<li>A visualization that allows you to understand the impact of your data.</li>
</ul>
<ol start="7">
<li>Which Google Analytics visualization compares report data to the website average?</li>
</ol>
<ul>
<li>Pivot view</li>
<li><mark>Comparison view</mark></li>
<li>Performance view</li>
<li>Percentage view</li>
</ul>
<ol start="8">
<li>How can the amount of data in a sampled Google Analytics report be increased?</li>
</ol>
<ul>
<li>Apply additional filters</li>
<li>Remove the Secondary Dimension</li>
<li>Choose “Faster response” in the sampling pulldown menu</li>
<li><mark>Choose “Greater precision” in the sampling pulldown menu</mark></li>
</ul>
<ol start="9">
<li>When selecting “Share Template Link” in the dashboard, what will be shared?</li>
</ol>
<ul>
<li><mark>Dashboard only</mark></li>
<li>Data only</li>
<li>Dashboard and data</li>
<li>Neither dashboard nor data</li>
</ul>
<ol start="10">
<li>When a dashboard is shared with a user, that user can edit the dashboard configuration as they see it.</li>
</ol>
<ul>
<li><mark>True</mark></li>
<li>False</li>
</ul>
<h2 id="note">Note</h2>
<p><strong>Users Metric</strong><br>
&quot;Users&quot; are individuals that had at least one session on your site in the given date range.</p>
<p><strong>Pageviews Metric</strong><br>
&quot;Pageviews&quot; are the total number of times pages that included your Analytics tracking code were displayed to users. <mark>This includes repeated viewings of a single page by the same user.</mark></p>
<p><strong>Pages/Session Metric</strong><br>
&quot;Pages per session&quot; is the average number of pages viewed during each session. This also includes repeated viewings of a single page.</p>
<p><strong>Bounce Rate metric</strong><br>
&quot;Bounce rate&quot; is the percentage of users who left after viewing a single page on your site and taking no additional action.</p>
<p><span style="color:blue">some <em>blue</em> text</span>.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Google Analytics for Beginners Assessment 1]]></title>
        <id>https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-1/</id>
        <link href="https://gilgamel.github.io/post/google-analytics-for-beginners-assessment-1/">
        </link>
        <updated>2021-09-12T02:53:56.000Z</updated>
        <content type="html"><![CDATA[<ol>
<li>Using tracking code, Google Analytics can report on data from which systems?</li>
</ol>
<ul>
<li><mark>E-commerce platforms</mark></li>
<li><mark>Mobile Applications</mark></li>
<li><mark>Online point-of-sales systems</mark></li>
<li>Systems not connected to the Internet</li>
</ul>
<ol start="2">
<li>To collect data using Google Analytics, which steps must be completed?</li>
</ol>
<ul>
<li>Install Google Analytics desktop software</li>
<li><mark>Create an Analytics account</mark></li>
<li><mark>Add Analytics tracking code to each webpage</mark></li>
<li>Download the Analytics app</li>
</ul>
<ol start="3">
<li>The Analytics tracking code can collect which of the following?</li>
</ol>
<ul>
<li><mark>Language the browser is set to</mark></li>
<li><mark>Type of browser</mark></li>
<li>User’s favorite website</li>
<li><mark>Device and operating system</mark></li>
</ul>
<ol start="4">
<li>When will Google Analytics end a session by default?</li>
</ol>
<ul>
<li>After 30 minutes, regardless of user activity on your website</li>
<li>Once the user opens another browser window</li>
<li><mark>When a user is inactive on your site for 30 minutes or more or closes a browser window</mark></li>
<li>At noon every day</li>
</ul>
<ol start="5">
<li>Once Google Analytics processes data, it’s stored in a database where it can’t be modified.</li>
</ol>
<ul>
<li><mark>True</mark></li>
<li>False</li>
</ul>
<ol start="6">
<li>Which represents the hierarchical structure of a Google Analytics account from top to bottom?</li>
</ol>
<ul>
<li>View &gt; Account &gt; Property</li>
<li>Property &gt; Account &gt; View</li>
<li>Account &gt; View &gt; Property</li>
<li><mark>Account &gt; Property &gt; View</mark></li>
</ul>
<ol start="7">
<li>A user with “edit” permissions at the Account level will automatically have “edit” permissions at which other levels?</li>
</ol>
<ul>
<li>User</li>
<li><mark>Property</mark></li>
<li><mark>View</mark></li>
<li>Product</li>
</ul>
<ol start="8">
<li>To locate a property's Analytics tracking code, which sequence of steps should be followed?</li>
</ol>
<ul>
<li>Admin &gt; Tracking Code &gt; Tracking Info</li>
<li><mark>Admin &gt; Tracking Info &gt; Tracking Code</mark></li>
<li>Reports &gt; Audience &gt; Tracking Code</li>
<li>Audience Reports &gt; Settings &gt; Tracking Code</li>
</ul>
<ol start="9">
<li>To use Analytics to collect website data, what must be added to the website page HTML?</li>
</ol>
<ul>
<li>Google campaign parameters</li>
<li>Google Analytics terms and conditions</li>
<li><mark>Google Analytics tracking code</mark></li>
<li>A permissions button</li>
</ul>
<ol start="10">
<li>Where should the Analytics tracking code be placed in the HTML of a webpage to collect data?</li>
</ol>
<ul>
<li><mark>Immediately after the opening &lt; head &gt; tag of your website/<mark></li>
<li>Immediately before the closing &lt; /head &gt; tag of your website</li>
<li>Immediately after the opening &lt; body &gt; tag of your website</li>
<li>Immediately before the closing &lt; /body &gt; tag of your website)</li>
</ul>
<p>Note: 答案跟 google AdSense Help 中似乎有点不同，不确定是否属于同一设置<br>
<img src="https://gilgamel.github.io/post-images/1631503071763.png" alt="" loading="lazy"></p>
<p>Ref: https://support.google.com/adsense/answer/6090817?hl=en</p>
<ol start="11">
<li>When a new view is created, what data will be included?</li>
</ol>
<ul>
<li>Data from before the view was created</li>
<li><mark>Data from after the view was created</mark></li>
<li>Data from before and after the view was created</li>
<li>No data</li>
</ul>
<ol start="12">
<li>A deleted view can be recovered by account administrators within how many days?</li>
</ol>
<ul>
<li><mark>35</marlk></li>
<li>65</li>
<li>95</li>
<li>125</li>
</ul>
<ol start="13">
<li>What are the options for filtering data in Google Analytics?</li>
</ol>
<ul>
<li>Exclude data from a view</li>
<li>Include data in a view</li>
<li>Modify how data appears in your reports</li>
<li><mark>All of the above</mark></li>
</ul>
<ol start="14">
<li>Why is it important to keep one unfiltered view when using filters with Google Analytics?</li>
</ol>
<ul>
<li><mark>To ensure you can always access the original data</mark></li>
<li>In order to configure Goals</li>
<li>In order to use a filter for multiple views</li>
<li>There is no reason to have an unfiltered view</li>
</ul>
<ol start="15">
<li>In which order does Google Analytics filter data?</li>
</ol>
<ul>
<li>Alphabetical order by filter name</li>
<li>The order in which the filters were last edited</li>
<li><mark>The order in which the filters are applied</mark></li>
<li>Randomized order</li>
</ul>
<ol start="16">
<li>When a filter is applied to a view, what data is affected?</li>
</ol>
<ul>
<li>Data from before the filter was created</li>
<li><mark>Data from after the filter was created</mark></li>
<li>All the data available in a view</li>
<li>None of the data available in a view</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[FIRST JUMP — SKYDIVE IN TORONTO]]></title>
        <id>https://gilgamel.github.io/post/first-jump-skydive-in-toronto/</id>
        <link href="https://gilgamel.github.io/post/first-jump-skydive-in-toronto/">
        </link>
        <updated>2021-09-04T03:35:29.000Z</updated>
        <content type="html"><![CDATA[<p>距离跳伞已经过了一个多月了，拖延症晚期终于开始写下关于这次跳伞的 blog。<br>
</br></p>
<h2 id="地址选择">地址选择</h2>
<p>在准备跳伞之前问了一下身边跳过伞的朋友以及在网上做了一些搜索，初步定下来两间距离多伦多相对较近的两间 Skydive，分别是：</p>
<ul>
<li>位于 Barrie 附近的 Skydive Toronto https://www.skydivetoronto.com/</li>
<li>以及号称能够看到瀑布的 Niagara Skydive Centre https://niagaraskydive.com/</li>
</ul>
<table>
<thead>
<tr>
<th>Location</th>
<th>Pkg Option</th>
<th>Pkg Price</th>
<th>Pkg Feature</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>Skydive Toronto Barrie</td>
<td>10500 FT</td>
<td>$328 +HST.</td>
<td>Approximately 35 seconds of freefall before a five-minute parachute ride down to the ground.</td>
<td>车程约 60分钟 Camera Pkg inside $150+HST, outside $185+HST, both $295+HST</td>
</tr>
<tr>
<td>Skydive Toronto Barrie</td>
<td>12250 FT</td>
<td>$372 +HST.</td>
<td>Approximately 45 seconds of freefall before a five-minute parachute ride down to the ground.</td>
<td>车程约 60分钟 Camera Pkg inside $150+HST, outside $185+HST, both $295+HST</td>
</tr>
<tr>
<td>Niagara Skydive Centre</td>
<td>Tandem Skydive</td>
<td>$319 +HST.</td>
<td>10,500 feet or 12,500 feet is about 25 minutes (depending on the airplane used), circling Niagara Falls1 on the way up.  Freefall for approximately 45 seconds</td>
<td>车程约 1小时 50 分钟 Camera Pkg inside $125+HST, outside $165+HST, both $249+HST</td>
</tr>
<tr>
<td>Niagara Skydive Centre</td>
<td>Weekday Tandem</td>
<td>$309 +HST.</td>
<td>10,500 feet or 12,500 feet is about 25 minutes (depending on the airplane used), circling Niagara Falls1 on the way up.  Freefall for approximately 45 seconds</td>
<td>车程约 1小时 50 分钟 Camera Pkg inside $125+HST, outside $165+HST, both $249+HST</td>
</tr>
</tbody>
</table>
<p>由于一起去的朋友住在 Downtown，因此选择到 Downtown pickup 再去 Niagara Fall 那块是顺路的，所以最终选择了 Niagara Fall Skydive Centre。</p>
<h2 id="booking">Booking</h2>
<p>我们最后选择的是 Group of 7，也就是团体价格，每人 - $20， 并且 Niagara Fall Skydive Centre 会给组织者送一个 inside camera pkg，所以实际价格（抛开额外购买的 camera pkg）是大约 $340.5。</p>
<p>Online Booking 提前给 $50/person deposit fee，提前 48 小时取消可取回全部 deposit。</p>
<p>接着邮箱会收到 Niagara Fall Centre 发给你的协议，需要电子签，内容大概是 extreme sport 是有概率出现的意外的，签下这份协议代表你同意不追究 blablabla；另外一份则是 Liability Waiver 及 covid-19 screening。</p>
<p><strong>收到的要求填 waiver 的截图</strong><br>
<img src="https://gilgamel.github.io/post-images/1631485760648.png" alt="Waiver" loading="lazy"></p>
<p><strong>Liability Waiver and Covid-19 screening 邮件截图</strong><br>
<img src="https://gilgamel.github.io/post-images/1631485958896.png" alt="" loading="lazy"></p>
<p>在去之前分别点击邮件里的链接，按照要求填写即可。</p>
<h2 id="路程">路程</h2>
<p>虽然 google maps 写的是约 2小时到，但我们还是小看了长周末 highway 401 的堵车了，早上9点不到从家里出发到了 downtown 大概 9点40 左右，之后为了赶时间并没有在 downtown 吃东西直接开车去了 Hamilton，中间堵了很长一段时间。</p>
<p>随意找了一间刚开的早茶店想迅速吃点东西，最终卡着时间 11点30 东西都没齐就直接跑了，最后踩着点到了地方。<br>
</br></p>
<h2 id="sign-in-等待">Sign-in — 等待</h2>
<p>全程 sign-in 非常的快，但由于是分开来了， group member 没有到，导致我们是额外购买的 Camera pkg，再加上是饭点，等了很久很久。</p>
<figure data-type="image" tabindex="1"><img src="https://gilgamel.github.io/post-images/1631487403925.jpg" alt="" loading="lazy"></figure>
<p>室内是严格戴口罩的，在室外可以摘了口罩。不过怕死 + 为了防晒，全程戴着口罩。<br>
最重要的一点是参加这样的室外活动，真的要涂防晒！<br>
一起去的朋友里有一位不怕死的全程不涂防晒，最后 sunburn 了。<br>
</br><br>
在网站说明上说大约要 4 小时，原来是 sign-in 5分钟，看 video 10 分钟，trainning 10 分钟，等待 3小时，飞机上 30分钟，自由落体 45s，在空中滞留 5-10分钟。<br>
</br><br>
在等待的时候就一直在打扑克，拍拍照片。<br>
企图用别人跳伞的图片冒充自己（。反正这么远谁都不会发现不是自己哈哈哈哈哈）<br>
<img src="https://gilgamel.github.io/post-images/1631487544126.jpg" alt="" loading="lazy"><br>
</br></p>
<h2 id="起飞-起跳">起飞 — 起跳</h2>
<p>等了 3 个多小时终于上了飞机，一架飞机大概能够坐 10 个人左右，除了我们这群小菜鸡由教练带着跳以外，还有两个大神是自己跳的。</p>
<p>从准备出发开始教练就非常 nice 的跟你寒暄啦，然后拿着 GO PRO 对着你拍，于是尴尬癌立刻发作（。<br>
坐在飞机上的时候经过了 LAKE ONTARIO 什么的教练也会给你指出来，飞机会经过 Niagara Fall 两次，虽然没戴眼镜，但还时能够用意念感觉出来很好看。（就是有点晕机）特别是当飞机正在上升的时候看到远处有云，于是有可能在我们这一批跳完以后就没办法再继续了。</p>
<p>等飞机盘旋到 12500 ft 的时候，朋友开始像下饺子一样一个个往下下，而我是最后一个 ：），越看越害怕，跳下去之前已经想好了出现意外的 100 种方式了。</p>
<p>不过等真的跳下去的一瞬间有瞬间失重的感觉，转瞬即逝，接着开始了自由落体，那种感觉非常的奇妙，像是在用不同的角度去看这个世界，特别是当你是一个瞎子的时候，还能安慰自己有一种朦胧美。</p>
<p><img src="https://gilgamel.github.io/post-images/1631488011868.jpg" alt="" loading="lazy"><br>
看到高空的时候想张口呐喊，然后发现自己被风吹得面目全非。<br>
这个时候就特别佩服跳伞还能保持仪容仪表的李总裁。</p>
<p>在持续了大概 45s 自由落体以后，教练打开了降落伞。<br>
然后开始在 1500 米左右的高空缓缓降落。</p>
<p>教练：See, there is Toronto<br>
我：Where? There?<br>
教练：Yes!<br>
我：Wow! But I can't see it T-T<br>
教授：Aha</p>
<p>在空中挂了 5 分钟以后看到感觉很好看又不完全好看的景色，看到了 3 个朋友先后降落，最终跪着到了地面 （。 每当这个时候就觉得自己的脚柔韧度真的不咋滴</p>
<p>落到了地面 4 个人在那哈哈哈哈哈，然后发现头发也都打结了，像个捡破烂的一样穿着的装备走回了基地。<br>
而且整个人极度兴奋，跳之前：我再也不会跳第二次！ 跳之后：啥时候再来一次？</p>
<p>哦对了，当你跳完以后会秒给你发一个邮件，里面有一张证书，恭喜你完成了 First Jump，就很有仪式感。</p>
<figure data-type="image" tabindex="2"><img src="https://gilgamel.github.io/post-images/1631488424116.png" alt="" loading="lazy"></figure>
<h2 id="关于高度近视是否可以跳伞">关于高度近视是否可以跳伞</h2>
<p>在跳之前只想到会死，没想到可能会引发视网膜脱落。在朋友的提醒下，先浏览了网站，发现并没有说禁止高度近视跳伞，保险起见再 google 了一下，发现回答的多数是跳伞基地的工作人员，有利益关系。于是直接去问了 eye clinic 的医生，确定了 900 度近视完全可以去跳伞，于是愉快的放飞了自我。</p>
<p>不过如果是近视建议还是戴隐形眼镜或不戴。在准备上飞机之前教练也建议我将眼镜摘了，后来看了一些跳伞视频发现护目镜外形都差不多，会勒得眼睛附近出印子，在这个基础上戴普通眼镜的话估计会很难受。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[通过 Query、Importrange、Select、Where 将多张 Google Sheets 合并到一起]]></title>
        <id>https://gilgamel.github.io/post/google-sheets-merge-multiple-sheets/</id>
        <link href="https://gilgamel.github.io/post/google-sheets-merge-multiple-sheets/">
        </link>
        <updated>2021-04-03T20:20:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="背景">背景</h2>
<p>公司每个学期所做的 Budget 都放在 Google Sheet，大概每2-4周会出现频繁修改的情况，因此需要实时保持更新并连接到 PBI。</p>
<p>在之前曾经试过 Custom Goolge Sheet Connector，但由于 Connector 只能在 Desktop 使用，会影响将报表 push 到 PBI Service 后的刷新；也曾经试过将 Power Query 写到 PBI Service 上，但由于 credential 问题，会导致后续无法刷新。</p>
<p>由于每个分公司的 Budget 都会在一张 spreadsheet 上，基于保密因此需要先将分公司的 Budget 有选择性地抓到同一张表上，再连接到 PBI Service 上。</p>
</br>
<h2 id="总结">总结</h2>
<p>基于以上背景，可简单总结为以下两个目的：</p>
<ol>
<li>Merge Multiple Sheets into One Sheet</li>
<li>Connect Goolge Sheet to PBI Service and Configure Scheduled Refresh</li>
</ol>
</br>
<h2 id="step-1-merge-multiple-sheets">STEP 1. Merge Multiple Sheets</h2>
<h3 id="step-11-filter-importrange失败的尝试">STEP 1.1 Filter + Importrange，失败的尝试</h3>
</br>
<p><strong>Filter Synatax</strong><br>
<code>FILTER(range, condition1, [condition2, ...])</code></p>
<ul>
<li><strong>range</strong> - The data to be filtered</li>
<li><strong>condition1</strong> - A column or row containing true or false values corresponding to the first column or row of range, or an array formula evaluating to true or false.</li>
</ul>
</br>
<pre><code>= {
    FILTER(IMPORTRANGE(&quot;{Spreadsheet_link1}&quot;,&quot;Sheet_name!A2:A&quot;),
    LEN(IMPORTRANGE(&quot;{Spreadsheet_link},&quot;Sheet_name!H2:H))&gt;0;
    FILTER(IMPORTRANGE(&quot;{Spreadsheet_link2}&quot;,&quot;Sheet_name!A3:A&quot;),
    LEN(IMPORTRANGE(&quot;{Spreadsheet_link2}&quot;,&quot;Sheet_name!H3:H&quot;))&gt;0)
}
</code></pre>
</br>
<ul>
<li><strong>{Spreadsheet_link1}</strong> 分公司A的 Google Sheet Link</li>
<li><strong>{Spreadsheet_link2}</strong> 分公司B的 Google Sheet Link</li>
<li><strong>Sheet_name1!A2:A</strong>由于是第一次抓表，因此需要将标题也一同抓取。在这次的 Budget 表里第二行为标题，因此公司A的表格从A2开始抓起</li>
<li><strong>Sheet_name2!A3:A</strong>接着是 merge 公司B的表格，由于此时已不需要标题了，因此可以由 A3 开始抓起</li>
<li>通过 FILTER以及LEN 将已经没有填写完成的内容暂时放弃抓取，LEN里的 <strong>filter</strong> 判定行数需要跟 <strong>importrange</strong> 保持一致<br>
</br></li>
</ul>
<p>到此为止，其实已经可以成功将各分公司的表格合并到一起。但出于信息安全保密问题，因此需要跳列只抓取最为重要的几列，以确保及时资料外泄对方也不知道具体产品的对应 Budget 是多少。</p>
<p>由于 filter 跟 importrange 均无法跳列，因此开始尝试使用 query + select + where + importrange 的组合进行数据抓取。<br>
</br></p>
<h3 id="step-12-query-importrange-select-where">STEP 1.2 Query + Importrange + Select + Where</h3>
<p><strong>Query Syntax</strong><br>
<code>Query(data, query, [headers])</code></p>
<ul>
<li><strong>data</strong> - The range of cells to perform the query on</li>
<li><strong>query</strong> - The query to perform, written in the Google Visualization API Query Language</li>
<li><strong>headers</strong> - [OPTIONAL] - The number of header rows at the top of data. If omitted or set to -1, the value is guessed based on the content of data</li>
</ul>
<p><strong>Importrange Syntax</strong><br>
<code>IMPORTRANGE(spreadsheet_url, range_string)</code></p>
<ul>
<li><strong>spreadsheet_url</strong> - The URL of the spreadsheet from where data will be imported</li>
<li><strong>range_string</strong> - A string, of the format &quot;[sheet_name!]range&quot; (e.g. &quot;Sheet1!A2:B6&quot; or &quot;A2:B6&quot;) specifying the range to import</li>
</ul>
</br>
<pre><code>= {
    =QUERY({IMPORTRANGE(&quot;{Spreadsheet_ID1}&quot;,
    &quot;Sheet_name1!A:V&quot;);
    IMPORTRANGE(&quot;{Spreadsheet_ID2}&quot;,&quot;Sheet_name2!A:V&quot;);
    IMPORTRANGE(&quot;{Spreadsheet_ID3}&quot;,&quot;Sheet_name3!A:V&quot;)},
    &quot;SELECT Col1,Col8,Col10,Col16,Col17,Col18,Col20,Col22 WHERE Col10 &gt; 0&quot;,2)
}
</code></pre>
<ul>
<li><strong>Spreadsheet_ID1</strong> https://docs.google.com/spreadsheets/d/{Spreadsheet_ID}/edit#gid=0
<ul>
<li>在写 Query 的过程中发现只填写 Spreadsheet_ID 也能成功读取</li>
</ul>
</li>
<li>SELECT ... WHERE 典型的 SQL 用法</li>
<li>在 Google Sheet 里 Col 代表着 Column，一般情况下输入 A, B, C 或 Column1, Column2, Column3 均会被认为找不到该 Column</li>
</ul>
</br>
<h4 id="note">Note</h4>
<p>使用 Query + Select + Where + Importrange 时，第一次会出现错误，原因是没有获取读取表格的 access，因此需要先在新的表上读取一次 importrange，再将 importrange function 放进 query里。</p>
<p>第一次用 importrange 读取新表会出现以前情况，点击<strong>Allow access</strong>即可。<br>
<img src="https://gilgamel.github.io/post-images/1617726487957.png" alt="" loading="lazy"></p>
<p>自此，合并各分公司表格工作完成。<br>
开始第二步：将数据放到 PBI Service 上，让数据能够定时刷新。</p>
</br>
<h2 id="step-2-connect-goolge-sheet-to-pbi-service-and-configure-scheduled-refresh">STEP 2. Connect Goolge Sheet to PBI Service and Configure Scheduled Refresh</h2>
<p>在将合并好的 Google Sheet 设置成 “Anyone can view with link”以后，原本想直接在 PBI Service 上直接通过 Web/Web API 的形式进行连接，但一直显示需要需要安装并选择网关才能设置成功。由于安装网关对电脑负荷过大，因此一样采取老办法：尝试利用 Power Query 抓取数据。</p>
<h3 id="step-21-修改-shareable-link">STEP 2.1 修改 shareable link</h3>
<p>根据 Stackoverflow 上的Solution，需要将 shareable link 作出以下修改：</p>
</br>
<p><strong>From</strong><br>
<code>https://docs.google.com/spreadsheets/d/{spreadsheet_ID}/edit#gid=0</code></p>
<blockquote>
</br>
</blockquote>
<p><strong>To</strong><br>
<code>https://docs.google.com/spreadsheets/d/{spreadsheet_ID}/export?format=xlsx&amp;id={spreadsheet_ID}</code></p>
</br>
<ul>
<li><strong>export?format=xlsx&amp;id={spreadsheet_ID}</strong> - 将已经分享出来的 Google Sheet 输出为 xlsx 格式；且再次 identify spreadsheet via spreadsheet_ID</li>
</ul>
<h3 id="step-22-攥写-power-query">STEP 2.2 攥写 Power Query</h3>
<ol>
<li>打开 app.powerbi.com</li>
<li>打开相对应的 Workspace。根据个人习惯，我建立了一个叫 DATAFLOW 的 Workspace，专门用于刷新数据</li>
<li>选择<strong>新建数据流</strong>，见下图</li>
</ol>
<p><img src="https://gilgamel.github.io/post-images/1617730510237.png" alt="" loading="lazy"><br>
4. 由于这是我第一次尝试从 Google Sheet 抓取数据，我选择<strong>定义新表</strong></p>
<p><img src="https://gilgamel.github.io/post-images/1617730529275.png" alt="" loading="lazy"><br>
5. 选择最下方的<strong>空白查询</strong></p>
<figure data-type="image" tabindex="1"><img src="https://gilgamel.github.io/post-images/1617730575163.png" alt="" loading="lazy"></figure>
<p>输入以下 Query Code：</p>
<pre><code>let 
    Source = Excel.Workbook(Web.Contents(&quot;the-link-in-step-2.1&quot;), null, true）
in 
    Source
</code></pre>
<ol start="6">
<li>重命名并保存退出</li>
<li>返回到 DATAFLOW 界面，选择刚才创建的数据流，并选择<strong>设置</strong></li>
</ol>
<p><img src="https://gilgamel.github.io/post-images/1617730834159.png" alt="" loading="lazy"><br>
8. 数据源凭证 — 编辑凭据 — 勾选“<strong>跳过测试连接</strong>“</p>
<figure data-type="image" tabindex="2"><img src="https://gilgamel.github.io/post-images/1617730938911.png" alt="" loading="lazy"></figure>
<p>自此，通过 Power Query 在 PBI Service 上抓取 Google Sheet 的目的已完成。<br>
最后一步便是设置定时刷新。</p>
<h3 id="step-23-configure-scheduled-refresh">STEP 2.3 Configure Scheduled Refresh</h3>
<p>PBI Pro Lincense 每天可以设置8次定时刷新，因此我一般选择每三个小时刷新一次。</p>
<p>操作如下：</p>
<ul>
<li>数据流设置 — 计划的更新 — 选择相对应的时区及刷新频率 — 选择需要刷新的时间段</li>
</ul>
</br>
<h2 id="other">Other</h2>
<p>在查询如何通过Power Query 过程中发现还有一种方法，即通过 Google BigQuery 将数据存储到上面，再利用 Power Query 抓取 BigQuery 上的数据。</p>
<p>BigQuery 被誉为 <strong>secure method</strong>，而目前使用的方法则相对的 <strong>insecure</strong>，后续迭代可以尝试一下。</p>
<p>另外一个发现，移动 Google Sheet 的位置并不会影响它的spreadsheet_ID，因此在 Personal Drive 上测试完以后基于共享，后续将 Google Sheet 移动到 Shared Drive 也毫无障碍，这点必须好评。</p>
</br>
<h2 id="ref">Ref</h2>
<blockquote>
<p>https://stackoverflow.com/questions/45945815/how-to-connect-google-sheet-with-power-bi</p>
<p>https://webapps.stackexchange.com/questions/85101/queryimportrange-function-to-skip-columns</p>
<p>https://webapps.stackexchange.com/questions/93002/unable-to-parse-query-string-for-function-query-when-using-importrange</p>
<p>https://blog.coupler.io/combine-sheets-into-one/</p>
<p>https://blog.coupler.io/query-importrange/#What_you_can_do_with_IMPORTRANGEQUERY_functions_real-life_formula_examples</p>
<p>https://support.google.com/docs/answer/3093343?hl=en</p>
<p>https://support.google.com/docs/answer/3093197?hl=en</p>
<p>https://gist.github.com/Spencer-Easton/78f9867a691e549c9c70</p>
<p>https://www.excelinppc.com/using-google-sheets-as-data-source-in-power-query</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Nespresso Vertuo Coffee Capsules 口味记录]]></title>
        <id>https://gilgamel.github.io/post/nespresso-vertuo-coffee-capsules-kou-wei-ji-lu/</id>
        <link href="https://gilgamel.github.io/post/nespresso-vertuo-coffee-capsules-kou-wei-ji-lu/">
        </link>
        <updated>2021-02-25T04:41:28.000Z</updated>
        <content type="html"><![CDATA[<h2 id="solelio">Solelio</h2>
<ul>
<li>Intensity: 2/10</li>
<li>Cup Size: 230ml</li>
<li>Aromatic Profile: Fruity and Light-Bodied</li>
<li>Aromatic Notes: Citric, Cereal</li>
</ul>
<p>整体口感温和，烘培感跟果味的平衡恰到好处，但在冷却后酸度会大为提升。</p>
]]></content>
    </entry>
</feed>